<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TimberTON - –†—É–±–∏ –¥–µ—Ä–µ–≤—å—è –∑–∞ TON</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    touch-action: manipulation;
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
}

:root {
    --bg-dark: #0f0f1e;
    --bg-card: #1a1a2e;
    --bg-hover: #252542;
    --primary: #ffd700;
    --primary-dark: #e6c200;
    --secondary: #00d4ff;
    --success: #00ff88;
    --danger: #ff4757;
    --text: #ffffff;
    --text-muted: #a0a0b0;
    --border: #2a2a4a;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--bg-dark);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
}

.hidden {
    display: none !important;
}

.screen {
    display: none;
    min-height: 100vh;
    padding-bottom: 20px;
}

.screen.active {
    display: block;
}

.header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.95);
    backdrop-filter: blur(10px);
    padding: 12px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 100;
    border-bottom: 1px solid var(--border);
}

.balance-display {
    display: flex;
    gap: 16px;
}

.balance-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 14px;
    font-weight: 600;
}

.balance-item .icon {
    font-size: 16px;
}

.menu-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    width: 40px;
    height: 40px;
    border-radius: 12px;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.2s;
}

.menu-btn:active {
    transform: scale(0.95);
    background: var(--bg-hover);
}

#main-screen {
    padding-top: 80px;
}

.logo-section {
    text-align: center;
    padding: 30px 20px;
}

.logo-icon {
    font-size: 80px;
    margin-bottom: 10px;
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.logo-section h1 {
    font-size: 32px;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary) 0%, #ffed4e 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 8px;
}

.subtitle {
    color: var(--text-muted);
    font-size: 14px;
}

.game-preview {
    position: relative;
    height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 20px 0;
}

.preview-tree {
    font-size: 120px;
    position: absolute;
    animation: sway 4s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes sway {
    0%, 100% { transform: rotate(-2deg); }
    50% { transform: rotate(2deg); }
}

.preview-lumberjack {
    font-size: 60px;
    position: absolute;
    bottom: 20px;
    right: 30%;
    animation: chop 1s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes chop {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(-20deg); }
}

.main-actions {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.btn {
    border: none;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.btn:active {
    transform: scale(0.98);
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: #000;
    padding: 18px 32px;
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
}

.btn-primary:active {
    box-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
}

.btn-secondary {
    background: var(--bg-card);
    color: var(--text);
    padding: 16px 24px;
    border: 1px solid var(--border);
}

.btn-secondary:active {
    background: var(--bg-hover);
}

.btn-info {
    background: transparent;
    color: var(--text-muted);
    padding: 14px 24px;
    border: 1px solid var(--border);
}

.btn-large {
    font-size: 18px;
    padding: 20px 40px;
}

.btn-row {
    display: flex;
    gap: 12px;
}

.btn-row .btn {
    flex: 1;
}

.screen-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.95);
    backdrop-filter: blur(10px);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 100;
    border-bottom: 1px solid var(--border);
    padding-top: 60px;
}

.back-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    width: 44px;
    height: 44px;
    border-radius: 12px;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.screen-header h2 {
    font-size: 20px;
    font-weight: 700;
}

#game-menu-screen {
    padding-top: 120px;
}

.bet-container {
    padding: 20px;
}

.section {
    margin-bottom: 24px;
}

.section label {
    display: block;
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 12px;
    font-weight: 500;
}

.currency-tabs {
    display: flex;
    gap: 8px;
    background: var(--bg-card);
    padding: 4px;
    border-radius: 12px;
}

.currency-tab {
    flex: 1;
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 14px;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.currency-tab.active {
    background: var(--primary);
    color: #000;
}

.bet-amount {
    font-size: 48px;
    font-weight: 800;
    text-align: center;
    color: var(--primary);
    margin: 20px 0;
    text-shadow: 0 2px 20px rgba(255, 215, 0, 0.3);
}

.bet-slider {
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: var(--bg-card);
    outline: none;
    -webkit-appearance: none;
    margin: 20px 0;
}

.bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
}

.bet-presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.bet-presets button {
    flex: 1;
    min-width: 60px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.bet-presets button:active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.prize-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 24px 0;
}

.prize-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

.prize-card.win {
    border-color: var(--success);
    background: rgba(0, 255, 136, 0.05);
}

.prize-label {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.prize-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--primary);
}

.prize-card.win .prize-value {
    color: var(--success);
}

.prize-card small {
    display: block;
    margin-top: 8px;
    font-size: 12px;
    color: var(--text-muted);
}

.rules-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin: 24px 0;
}

.rules-box h4 {
    font-size: 16px;
    margin-bottom: 12px;
    color: var(--text);
}

.rules-box ul {
    list-style: none;
}

.rules-box li {
    padding: 8px 0;
    padding-left: 24px;
    position: relative;
    color: var(--text-muted);
    font-size: 14px;
}

.rules-box li:before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: var(--success);
    font-weight: bold;
}

#play-screen {
    padding-top: 60px;
    background: linear-gradient(180deg, var(--bg-dark) 0%, #1a1a3e 100%);
}

.time-bar {
    width: 100%;
    height: 6px;
    background: var(--bg-card);
    position: relative;
    overflow: hidden;
}

.time-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--success) 0%, var(--primary) 50%, var(--danger) 100%);
    width: 100%;
    transition: width 0.1s linear;
}

.score-board {
    text-align: center;
    padding: 30px 20px;
}

.current-score {
    font-size: 72px;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary) 0%, #ffed4e 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
}

.target-display {
    margin-top: 10px;
    color: var(--text-muted);
    font-size: 16px;
}

.combo-display {
    position: absolute;
    top: 120px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    font-size: 36px;
    font-weight: 800;
    color: var(--primary);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    opacity: 0;
    transition: all 0.3s;
    pointer-events: none;
}

.combo-display.show {
    transform: translateX(-50%) scale(1);
    opacity: 1;
}

.game-area {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 300px;
}

.tree-container {
    position: relative;
    width: 120px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 4px;
}

.trunk-section {
    width: 80px;
    height: 60px;
    background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
    border: 3px solid #5D3A1A;
    border-radius: 8px;
    position: relative;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
    from {
        transform: translateY(-20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.branch {
    position: absolute;
    width: 50px;
    height: 16px;
    background: linear-gradient(90deg, #228B22 0%, #32CD32 100%);
    border: 2px solid #006400;
    border-radius: 10px;
    top: 50%;
    transform: translateY(-50%);
}

.branch.left {
    left: -45px;
}

.branch.right {
    right: -45px;
}

.lumberjack {
    position: absolute;
    bottom: -90px;
    width: 70px;
    height: 80px;
    transition: all 0.15s;
    z-index: 10;
}

.lumberjack.left {
    left: -80px;
}

.lumberjack.right {
    right: -80px;
    transform: scaleX(-1);
}

.lumberjack.chopping {
    animation: chopAnim 0.15s ease-out;
}

@keyframes chopAnim {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(-25deg) translateX(-10px); }
    100% { transform: rotate(0deg); }
}

.lumberjack.right.chopping {
    animation: chopAnimRight 0.15s ease-out;
}

@keyframes chopAnimRight {
    0% { transform: scaleX(-1) rotate(0deg); }
    50% { transform: scaleX(-1) rotate(-25deg) translateX(-10px); }
    100% { transform: scaleX(-1) rotate(0deg); }
}

.lumberjack-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #ff6b6b 0%, #c92a2a 100%);
    border-radius: 12px 12px 24px 24px;
    position: relative;
    box-shadow: 0 6px 16px rgba(0,0,0,0.4);
}

.head {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
}

.axe {
    position: absolute;
    right: -25px;
    top: 20px;
    font-size: 30px;
    transform-origin: left center;
}

.game-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, var(--bg-dark) 0%, transparent 100%);
    display: flex;
    gap: 16px;
}

.chop-btn {
    flex: 1;
    height: 80px;
    border: none;
    border-radius: 20px;
    font-size: 36px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.1s;
    box-shadow: 0 8px 0 rgba(0,0,0,0.3), 0 15px 30px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
}

.chop-btn:active {
    transform: translateY(8px);
    box-shadow: 0 0 0 rgba(0,0,0,0.3), 0 5px 15px rgba(0,0,0,0.2);
}

.chop-btn.left {
    background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
    color: white;
}

.chop-btn.right {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
    color: white;
}

.chop-btn:after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.5s;
}

.chop-btn:active:after {
    left: 100%;
}

#result-screen {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    background: var(--bg-dark);
}

.result-content {
    text-align: center;
    width: 100%;
    max-width: 400px;
    animation: fadeInUp 0.5s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.result-icon {
    font-size: 80px;
    margin-bottom: 20px;
}

.result-content h2 {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 24px;
}

.result-content.win h2 {
    color: var(--success);
}

.result-content.lose h2 {
    color: var(--danger);
}

.result-stats {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
}

.stat {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
}

.stat:last-child {
    border-bottom: none;
}

.stat-label {
    color: var(--text-muted);
}

.stat-value {
    font-weight: 700;
    font-size: 18px;
}

.result-message {
    color: var(--text-muted);
    margin-bottom: 24px;
    line-height: 1.6;
}

.result-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

#deposit-screen, #withdraw-screen {
    padding-top: 120px;
}

.deposit-options, .withdraw-options {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.option-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 24px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}

.option-card:active {
    transform: scale(0.98);
    border-color: var(--primary);
    background: var(--bg-hover);
}

.option-icon {
    font-size: 48px;
    margin-bottom: 12px;
}

.option-card h3 {
    font-size: 20px;
    margin-bottom: 8px;
}

.option-card p {
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 8px;
}

.option-card small {
    color: var(--primary);
    font-size: 12px;
    font-weight: 600;
}

#deposit-ton-screen, #deposit-rub-screen,
#withdraw-ton-screen, #withdraw-rub-screen {
    padding-top: 120px;
}

.deposit-form, .withdraw-form {
    padding: 20px;
}

.info-box, .bank-card, .payment-id-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
}

.info-box h4, .payment-id-box h4 {
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.copy-box {
    background: var(--bg-dark);
    border: 2px dashed var(--border);
    border-radius: 12px;
    padding: 16px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
}

.copy-box:active {
    border-color: var(--primary);
    background: var(--bg-hover);
}

.copy-box code {
    display: block;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    word-break: break-all;
    color: var(--primary);
    margin-bottom: 8px;
}

.copy-hint {
    font-size: 12px;
    color: var(--text-muted);
}

.copy-box.important {
    border-color: var(--danger);
    background: rgba(255, 71, 87, 0.05);
}

.copy-box.important code {
    color: var(--danger);
    font-size: 18px;
    font-weight: 700;
}

.bank-card.sbp {
    background: linear-gradient(135deg, #0057b8 0%, #003d82 100%);
    border: none;
}

.bank-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.bank-logo {
    font-weight: 800;
    font-size: 20px;
    color: white;
}

.sbp-badge {
    background: white;
    color: #0057b8;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
}

.bank-phone {
    font-size: 24px;
    font-weight: 700;
    text-align: center;
    cursor: pointer;
    padding: 12px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

.bank-phone small {
    display: block;
    font-size: 12px;
    opacity: 0.8;
    margin-top: 4px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 8px;
}

.form-group input, .form-group select {
    width: 100%;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
    color: var(--text);
    font-size: 16px;
    outline: none;
    transition: all 0.2s;
}

.form-group input:focus, .form-group select:focus {
    border-color: var(--primary);
}

.form-group input::placeholder {
    color: var(--text-muted);
}

.balance-info {
    background: var(--bg-card);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 20px;
    text-align: center;
    color: var(--text-muted);
}

.balance-info strong {
    color: var(--primary);
    font-size: 20px;
}

.hint {
    text-align: center;
    color: var(--text-muted);
    font-size: 13px;
    margin-top: 16px;
    line-height: 1.5;
}

#history-screen {
    padding-top: 120px;
}

.history-tabs {
    display: flex;
    gap: 8px;
    padding: 0 20px;
    margin-bottom: 20px;
    overflow-x: auto;
}

.tab-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
}

.tab-btn.active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.history-list {
    padding: 0 20px;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: var(--text-muted);
}

.history-item {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border: 1px solid var(--border);
}

.history-item .info {
    flex: 1;
}

.history-item .type {
    font-weight: 600;
    margin-bottom: 4px;
}

.history-item .date {
    font-size: 12px;
    color: var(--text-muted);
}

.history-item .amount {
    font-weight: 700;
    font-size: 18px;
}

.history-item .amount.positive {
    color: var(--success);
}

.history-item .amount.negative {
    color: var(--danger);
}

.history-item .status {
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 20px;
    margin-left: 12px;
}

.status.pending {
    background: rgba(255, 215, 0, 0.1);
    color: var(--primary);
}

.status.completed {
    background: rgba(0, 255, 136, 0.1);
    color: var(--success);
}

.status.failed {
    background: rgba(255, 71, 87, 0.1);
    color: var(--danger);
}

.notification {
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-card);
    border: 1px solid var(--border);
    padding: 16px 24px;
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    z-index: 1000;
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

.wood-chip {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #DEB887;
    border-radius: 2px;
    pointer-events: none;
    animation: chipFly 0.5s ease-out forwards;
}

@keyframes chipFly {
    0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translate(var(--tx), var(--ty)) rotate(var(--rot));
        opacity: 0;
    }
}

@media (max-width: 380px) {
    .balance-display {
        gap: 12px;
    }
    
    .balance-item {
        font-size: 12px;
    }
    
    .current-score {
        font-size: 56px;
    }
    
    .chop-btn {
        height: 70px;
        font-size: 28px;
    }
    
    .bet-amount {
        font-size: 36px;
    }
}
    </style>
</head>
<body>
    <div class="header">
        <div class="balance-display">
            <div class="balance-item">
                <span class="icon">üíé</span>
                <span id="balance-ton">0.00</span> TON
            </div>
            <div class="balance-item">
                <span class="icon">‚ÇΩ</span>
                <span id="balance-rub">0</span>
            </div>
        </div>
        <button class="menu-btn" onclick="showScreen('main-screen')">üè†</button>
    </div>

    <div id="main-screen" class="screen active">
        <div class="logo-section">
            <div class="logo-icon">ü™ì</div>
            <h1>TimberTON</h1>
            <p class="subtitle">–†—É–±–∏ –¥–µ—Ä–µ–≤—å—è ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π TON –∏ —Ä—É–±–ª–∏!</p>
        </div>

        <div class="game-preview">
            <div class="preview-tree">üå≤</div>
            <div class="preview-lumberjack">ü™ì</div>
        </div>

        <div class="main-actions">
            <button class="btn btn-primary btn-large" onclick="showScreen('game-menu-screen')">
                üéÆ –ò–ì–†–ê–¢–¨
            </button>
            
            <div class="btn-row">
                <button center;
    justify-content: center;
    margin: 20px 0;
}

.preview-tree {
    font-size: 120px;
    position: absolute;
    animation: sway 4s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes sway {
    0%, 100% { transform: rotate(-2deg); }
    50% { transform: rotate(2deg); }
}

.preview-lumberjack {
    font-size: 60px;
    position: absolute;
    bottom: 20px;
    right: 30%;
    animation: chop 1s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes chop {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(-20deg); }
}

.main-actions {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.btn {
    border: none;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.btn:active {
    transform: scale(0.98);
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: #000;
    padding: 18px 32px;
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
}

.btn-primary:active {
    box-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
}

.btn-secondary {
    background: var(--bg-card);
    color: var(--text);
    padding: 16px 24px;
    border: 1px solid var(--border);
}

.btn-secondary:active {
    background: var(--bg-hover);
}

.btn-info {
    background: transparent;
    color: var(--text-muted);
    padding: 14px 24px;
    border: 1px solid var(--border);
}

.btn-large {
    font-size: 18px;
    padding: 20px 40px;
}

.btn-row {
    display: flex;
    gap: 12px;
}

.btn-row .btn {
    flex: 1;
}

.screen-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.95);
    backdrop-filter: blur(10px);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 100;
    border-bottom: 1px solid var(--border);
    padding-top: 60px;
}

.back-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    width: 44px;
    height: 44px;
    border-radius: 12px;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.screen-header h2 {
    font-size: 20px;
    font-weight: 700;
}

#game-menu-screen {
    padding-top: 120px;
}

.bet-container {
    padding: 20px;
}

.section {
    margin-bottom: 24px;
}

.section label {
    display: block;
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 12px;
    font-weight: 500;
}

.currency-tabs {
    display: flex;
    gap: 8px;
    background: var(--bg-card);
    padding: 4px;
    border-radius: 12px;
}

.currency-tab {
    flex: 1;
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 14px;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.currency-tab.active {
    background: var(--primary);
    color: #000;
}

.bet-amount {
    font-size: 48px;
    font-weight: 800;
    text-align: center;
    color: var(--primary);
    margin: 20px 0;
    text-shadow: 0 2px 20px rgba(255, 215, 0, 0.3);
}

.bet-slider {
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: var(--bg-card);
    outline: none;
    -webkit-appearance: none;
    margin: 20px 0;
}

.bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
}

.bet-presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.bet-presets button {
    flex: 1;
    min-width: 60px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.bet-presets button:active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.prize-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 24px 0;
}

.prize-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

.prize-card.win {
    border-color: var(--success);
    background: rgba(0, 255, 136, 0.05);
}

.prize-label {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.prize-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--primary);
}

.prize-card.win .prize-value {
    color: var(--success);
}

.prize-card small {
    display: block;
    margin-top: 8px;
    font-size: 12px;
    color: var(--text-muted);
}

.rules-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin: 24px 0;
}

.rules-box h4 {
    font-size: 16px;
    margin-bottom: 12px;
    color: var(--text);
}

.rules-box ul {
    list-style: none;
}

.rules-box li {
    padding: 8px 0;
    padding-left: 24px;
    position: relative;
    color: var(--text-muted);
    font-size: 14px;
}

.rules-box li:before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: var(--success);
    font-weight: bold;
}

#play-screen {
    padding-top: 60px;
    background: linear-gradient(180deg, var(--bg-dark) 0%, #1a1a3e 100%);
}

.time-bar {
    width: 100%;
    height: 6px;
    background: var(--bg-card);
    position: relative;
    overflow: hidden;
}

.time-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--success) 0%, var(--primary) 50%, var(--danger) 100%);
    width: 100%;
    transition: width 0.1s linear;
}

.score-board {
    text-align: center;
    padding: 30px 20px;
}

.current-score {
    font-size: 72px;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary) 0%, #ffed4e 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
}

.target-display {
    margin-top: 10px;
    color: var(--text-muted);
    font-size: 16px;
}

.combo-display {
    position: absolute;
    top: 120px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    font-size: 36px;
    font-weight: 800;
    color: var(--primary);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    opacity: 0;
    transition: all 0.3s;
    pointer-events: none;
}

.combo-display.show {
    transform: translateX(-50%) scale(1);
    opacity: 1;
}

.game-area {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 300px;
}

.tree-container {
    position: relative;
    width: 120px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 4px;
}

.trunk-section {
    width: 80px;
    height: 60px;
    background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
    border: 3px solid #5D3A1A;
    border-radius: 8px;
    position: relative;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
    from {
        transform: translateY(-20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.branch {
    position: absolute;
    width: 50px;
    height: 16px;
    background: linear-gradient(90deg, #228B22 0%, #32CD32 100%);
    border: 2px solid #006400;
    border-radius: 10px;
    top: 50%;
    transform: translateY(-50%);
}

.branch.left {
    left: -45px;
}

.branch.right {
    right: -45px;
}

.lumberjack {
    position: absolute;
    bottom: -90px;
    width: 70px;
    height: 80px;
    transition: all 0.15s;
    z-index: 10;
}

.lumberjack.left {
    left: -80px;
}

.lumberjack.right {
    right: -80px;
    transform: scaleX(-1);
}

.lumberjack.chopping {
    animation: chopAnim 0.15s ease-out;
}

@keyframes chopAnim {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(-25deg) translateX(-10px); }
    100% { transform: rotate(0deg); }
}

.lumberjack.right.chopping {
    animation: chopAnimRight 0.15s ease-out;
}

@keyframes chopAnimRight {
    0% { transform: scaleX(-1) rotate(0deg); }
    50% { transform: scaleX(-1) rotate(-25deg) translateX(-10px); }
    100% { transform: scaleX(-1) rotate(0deg); }
}

.lumberjack-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #ff6b6b 0%, #c92a2a 100%);
    border-radius: 12px 12px 24px 24px;
    position: relative;
    box-shadow: 0 6px 16px rgba(0,0,0,0.4);
}

.head {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
}

.axe {
    position: absolute;
    right: -25px;
    top: 20px;
    font-size: 30px;
    transform-origin: left center;
}

.game-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, var(--bg-dark) 0%, transparent 100%);
    display: flex;
    gap: 16px;
}

.chop-btn {
    flex: 1;
    height: 80px;
    border: none;
    border-radius: 20px;
    font-size: 36px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.1s;
    box-shadow: 0 8px 0 rgba(0,0,0,0.3), 0 15px 30px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
}

.chop-btn:active {
    transform: translateY(8px);
    box-shadow: 0 0 0 rgba(0,0,0,0.3), 0 5px 15px rgba(0,0,0,0.2);
}

.chop-btn.left {
    background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
    color: white;
}

.chop-btn.right {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
    color: white;
}

.chop-btn:after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.5s;
}

.chop-btn:active:after {
    left: 100%;
}

#result-screen {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    background: var(--bg-dark);
}

.result-content {
    text-align: center;
    width: 100%;
    max-width: 400px;
    animation: fadeInUp 0.5s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.result-icon {
    font-size: 80px;
    margin-bottom: 20px;
}

.result-content h2 {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 24px;
}

.result-content.win h2 {
    color: var(--success);
}

.result-content.lose h2 {
    color: var(--danger);
}

.result-stats {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
}

.stat {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
}

.stat:last-child {
    border-bottom: none;
}

.stat-label {
    color: var(--text-muted);
}

.stat-value {
    font-weight: 700;
    font-size: 18px;
}

.result-message {
    color: var(--text-muted);
    margin-bottom: 24px;
    line-height: 1.6;
}

.result-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

#deposit-screen, #withdraw-screen {
    padding-top: 120px;
}

.deposit-options, .withdraw-options {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.option-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 24px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}

.option-card:active {
    transform: scale(0.98);
    border-color: var(--primary);
    background: var(--bg-hover);
}

.option-icon {
    font-size: 48px;
    margin-bottom: 12px;
}

.option-card h3 {
    font-size: 20px;
    margin-bottom: 8px;
}

.option-card p {
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 8px;
}

.option-card small {
    color: var(--primary);
    font-size: 12px;
    font-weight: 600;
}

#deposit-ton-screen, #deposit-rub-screen,
#withdraw-ton-screen, #withdraw-rub-screen {
    padding-top: 120px;
}

.deposit-form, .withdraw-form {
    padding: 20px;
}

.info-box, .bank-card, .payment-id-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
}

.info-box h4, .payment-id-box h4 {
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.copy-box {
    background: var(--bg-dark);
    border: 2px dashed var(--border);
    border-radius: 12px;
    padding: 16px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
}

.copy-box:active {
    border-color: var(--primary);
    background: var(--bg-hover);
}

.copy-box code {
    display: block;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    word-break: break-all;
    color: var(--primary);
    margin-bottom: 8px;
}

.copy-hint {
    font-size: 12px;
    color: var(--text-muted);
}

.copy-box.important {
    border-color: var(--danger);
    background: rgba(255, 71, 87, 0.05);
}

.copy-box.important code {
    color: var(--danger);
    font-size: 18px;
    font-weight: 700;
}

.bank-card.sbp {
    background: linear-gradient(135deg, #0057b8 0%, #003d82 100%);
    border: none;
}

.bank-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.bank-logo {
    font-weight: 800;
    font-size: 20px;
    color: white;
}

.sbp-badge {
    background: white;
    color: #0057b8;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
}

.bank-phone {
    font-size: 24px;
    font-weight: 700;
    text-align: center;
    cursor: pointer;
    padding: 12px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

.bank-phone small {
    display: block;
    font-size: 12px;
    opacity: 0.8;
    margin-top: 4px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 8px;
}

.form-group input, .form-group select {
    width: 100%;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
    color: var(--text);
    font-size: 16px;
    outline: none;
    transition: all 0.2s;
}

.form-group input:focus, .form-group select:focus {
    border-color: var(--primary);
}

.form-group input::placeholder {
    color: var(--text-muted);
}

.balance-info {
    background: var(--bg-card);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 20px;
    text-align: center;
    color: var(--text-muted);
}

.balance-info strong {
    color: var(--primary);
    font-size: 20px;
}

.hint {
    text-align: center;
    color: var(--text-muted);
    font-size: 13px;
    margin-top: 16px;
    line-height: 1.5;
}

#history-screen {
    padding-top: 120px;
}

.history-tabs {
    display: flex;
    gap: 8px;
    padding: 0 20px;
    margin-bottom: 20px;
    overflow-x: auto;
}

.tab-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
}

.tab-btn.active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.history-list {
    padding: 0 20px;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: var(--text-muted);
}

.history-item {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border: 1px solid var(--border);
}

.history-item .info {
    flex: 1;
}

.history-item .type {
    font-weight: 600;
    margin-bottom: 4px;
}

.history-item .date {
    font-size: 12px;
    color: var(--text-muted);
}

.history-item .amount {
    font-weight: 700;
    font-size: 18px;
}

.history-item .amount.positive {
    color: var(--success);
}

.history-item .amount.negative {
    color: var(--danger);
}

.history-item .status {
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 20px;
    margin-left: 12px;
}

.status.pending {
    background: rgba(255, 215, 0, 0.1);
    color: var(--primary);
}

.status.completed {
    background: rgba(0, 255, 136, 0.1);
    color: var(--success);
}

.status.failed {
    background: rgba(255, 71, 87, 0.1);
    color: var(--danger);
}

.notification {
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-card);
    border: 1px solid var(--border);
    padding: 16px 24px;
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    z-index: 1000;
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

.wood-chip {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #DEB887;
    border-radius: 2px;
    pointer-events: none;
    animation: chipFly 0.5s ease-out forwards;
}

@keyframes chipFly {
    0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translate(var(--tx), var(--ty)) rotate(var(--rot));
        opacity: 0;
    }
}

@media (max-width: 380px) {
    .balance-display {
        gap: 12px;
    }
    
    .balance-item {
        font-size: 12px;
    }
    
    .current-score {
        font-size: 56px;
    }
    
    .chop-btn {
        height: 70px;
        font-size: 28px;
    }
    
    .bet-amount {
        font-size: 36px;
    }
}
    </style>
</head>
<body>
    <div class="header">
        <div class="balance-display">
            <div class="balance-item">
                <span class="icon">üíé</span>
                <span id="balance-ton">0.00</span> TON
            </div>
            <div class="balance-item">
                <span class="icon">‚ÇΩ</span>
                <span id="balance-rub">0</span>
            </div>
        </div>
        <button class="menu-btn" onclick="showScreen('main-screen')">üè†</button>
    </div>

    <div id="main-screen" class="screen active">
        <div class="logo-section">
            <div class="logo-icon">ü™ì</div>
            <h1>TimberTON</h1>
            <p class="subtitle">–†—É–±–∏ –¥–µ—Ä–µ–≤—å—è ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π TON –∏ —Ä—É–±–ª–∏!</p>
        </div>

        <div class="game-preview">
            <div class="preview-tree">üå≤</div>
            <div class="preview-lumberjack">ü™ì</div>
        </div>

        <div class="main-actions">
            <button class="btn btn-primary btn-large" onclick="showScreen('game-menu-screen')">
                üéÆ –ò–ì–†–ê–¢–¨
            </button>
            
            <div class="btn-row">
                <button class="btn btn-secondary" onclick="showScreen('deposit-screen')">
                    üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å
                </button>
                <button class="btn btn-secondary" onclick="showScreen('withdraw-screen')">
                    üí∏ –í—ã–≤–µ—Å—Ç–∏
                </button>
            </div>
            
            <button class="btn btn-info" onclick="showScreen('history-screen')">
                üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä
            </button>
        </div>
    </div>

    <div id="game-menu-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
        </div>

        <div class="bet-container">
            <div class="section">
                <label>–í–∞–ª—é—Ç–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="currency-tabs">
                    <button class="currency-tab active" onclick="selectCurrency('ton')" id="tab-ton">
                        üíé TON
                    </button>
                    <button class="currency-tab" onclick="selectCurrency('rub')" id="tab-rub">
                        ‚ÇΩ –†—É–±–ª–∏
                    </button>
                </div>
            </div>

            <div class="section">
                <label>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="bet-amount" id="bet-display">0.5 TON</div>
                <input type="range" class="bet-slider" id="bet-slider" 
                       min="0.5" max="10" step="0.5" value="0.5" 
                       oninput="updateBet(this.value)">
                <div class="bet-presets">
                    <button onclick="setBet(0.5)">0.5</button>
                    <button onclick="setBet(1)">1</button>
                    <button onclick="setBet(2)">2</button>
                    <button onclick="setBet(5)">5</button>
                    <button onclick="setBet(10)">10</button>
                </div>
            </div>

            <div class="prize-info">
                <div class="prize-card">
                    <div class="prize-label">üéØ –¶–µ–ª—å</div>
                    <div class="prize-value" id="target-score">50 –æ—á–∫–æ–≤</div>
                    <small>–ù–∞–±–µ—Ä–∏ –∑–∞ 30 —Å–µ–∫</small>
                </div>
                <div class="prize-card win">
                    <div class="prize-label">üèÜ –í—ã–∏–≥—Ä—ã—à</div>
                    <div class="prize-value" id="prize-amount">1.0 TON</div>
                    <small>x2 –æ—Ç —Å—Ç–∞–≤–∫–∏</small>
                </div>
            </div>

            <div class="rules-box">
                <h4>üìã –ü—Ä–∞–≤–∏–ª–∞:</h4>
                <ul>
                    <li>–†—É–±–∏ –¥–µ—Ä–µ–≤–æ –∫–Ω–æ–ø–∫–∞–º–∏ ‚Üê ‚Üí</li>
                    <li>–ò–∑–±–µ–≥–∞–π –≤–µ—Ç–æ–∫ ‚Äî –∏–Ω–∞—á–µ –ø—Ä–æ–∏–≥—Ä—ã—à!</li>
                    <li>–ö–∞–∂–¥—ã–π —É–¥–∞—Ä = +1 –æ—á–∫–æ</li>
                    <li>–ù–∞–±–µ—Ä–∏ —Ü–µ–ª—å –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è</li>
                </ul>
            </div>

            <button class="btn btn-primary btn-large" onclick="startGame()">
                ‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨ –ò–ì–†–£
            </button>
        </div>
    </div>

    <div id="play-screen" class="screen">
        <div class="time-bar">
            <div class="time-fill" id="time-fill"></div>
        </div>

        <div class="score-board">
            <div class="current-score" id="current-score">0</div>
            <div class="target-display">–¶–µ–ª—å: <span id="game-target">50</span></div>
        </div>

        <div class="combo-display" id="combo-display">x1</div>

        <div class="game-area">
            <div class="tree-container" id="tree">
                <div class="lumberjack left" id="lumberjack">
                    <div class="lumberjack-body">
                        <div class="head">üë∑</div>
                        <div class="axe">ü™ì</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-controls">
            <button class="chop-btn left" id="btn-left" ontouchstart="event.preventDefault(); chop('left')" onmousedown="chop('left')">‚Üê</button>
            <button class="chop-btn right" id="btn-right" ontouchstart="event.preventDefault(); chop('right')" onmousedown="chop('right')">‚Üí</button>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <div class="result-content" id="result-content">
            <div class="result-icon" id="result-icon">üèÜ</div>
            <h2 id="result-title">–ü–æ–±–µ–¥–∞!</h2>
            
            <div class="result-stats">
                <div class="stat">
                    <span class="stat-label">–û—á–∫–∏:</span>
                    <span class="stat-value" id="result-score">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                    <span class="stat-value" id="result-win">+1.0 TON</span>
                </div>
            </div>

            <div class="result-message" id="result-message">
                –û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!
            </div>

            <div class="result-actions">
                <button class="btn btn-primary" onclick="showScreen('game-menu-screen')">
                    üîÑ –ò–≥—Ä–∞—Ç—å –µ—â—ë
                </button>
                <button class="btn btn-secondary" onclick="showScreen('main-screen')">
                    üè† –í –º–µ–Ω—é
                </button>
            </div>
        </div>
    </div>

    <div id="deposit-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h2>
        </div>

        <div class="deposit-options">
            <div class="option-card" onclick="showScreen('deposit-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h3>
                <p>–û—Ç–ø—Ä–∞–≤—å TON –Ω–∞ –∞–¥—Ä–µ—Å –ø—Ä–æ–µ–∫—Ç–∞</p>
                <small>–ú–∏–Ω–∏–º—É–º: 1 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('deposit-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h3>
                <p>–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –°–ë–ü –Ω–∞ OZON –ë–∞–Ω–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 100 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="deposit-ton-screen" class="screen">
        <div center;
    justify-content: center;
    margin: 20px 0;
}

.preview-tree {
    font-size: 120px;
    position: absolute;
    animation: sway 4s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes sway {
    0%, 100% { transform: rotate(-2deg); }
    50% { transform: rotate(2deg); }
}

.preview-lumberjack {
    font-size: 60px;
    position: absolute;
    bottom: 20px;
    right: 30%;
    animation: chop 1s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes chop {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(-20deg); }
}

.main-actions {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.btn {
    border: none;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.btn:active {
    transform: scale(0.98);
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: #000;
    padding: 18px 32px;
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
}

.btn-primary:active {
    box-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
}

.btn-secondary {
    background: var(--bg-card);
    color: var(--text);
    padding: 16px 24px;
    border: 1px solid var(--border);
}

.btn-secondary:active {
    background: var(--bg-hover);
}

.btn-info {
    background: transparent;
    color: var(--text-muted);
    padding: 14px 24px;
    border: 1px solid var(--border);
}

.btn-large {
    font-size: 18px;
    padding: 20px 40px;
}

.btn-row {
    display: flex;
    gap: 12px;
}

.btn-row .btn {
    flex: 1;
}

.screen-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.95);
    backdrop-filter: blur(10px);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 100;
    border-bottom: 1px solid var(--border);
    padding-top: 60px;
}

.back-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    width: 44px;
    height: 44px;
    border-radius: 12px;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.screen-header h2 {
    font-size: 20px;
    font-weight: 700;
}

#game-menu-screen {
    padding-top: 120px;
}

.bet-container {
    padding: 20px;
}

.section {
    margin-bottom: 24px;
}

.section label {
    display: block;
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 12px;
    font-weight: 500;
}

.currency-tabs {
    display: flex;
    gap: 8px;
    background: var(--bg-card);
    padding: 4px;
    border-radius: 12px;
}

.currency-tab {
    flex: 1;
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 14px;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.currency-tab.active {
    background: var(--primary);
    color: #000;
}

.bet-amount {
    font-size: 48px;
    font-weight: 800;
    text-align: center;
    color: var(--primary);
    margin: 20px 0;
    text-shadow: 0 2px 20px rgba(255, 215, 0, 0.3);
}

.bet-slider {
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: var(--bg-card);
    outline: none;
    -webkit-appearance: none;
    margin: 20px 0;
}

.bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
}

.bet-presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.bet-presets button {
    flex: 1;
    min-width: 60px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.bet-presets button:active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.prize-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 24px 0;
}

.prize-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

.prize-card.win {
    border-color: var(--success);
    background: rgba(0, 255, 136, 0.05);
}

.prize-label {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.prize-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--primary);
}

.prize-card.win .prize-value {
    color: var(--success);
}

.prize-card small {
    display: block;
    margin-top: 8px;
    font-size: 12px;
    color: var(--text-muted);
}

.rules-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin: 24px 0;
}

.rules-box h4 {
    font-size: 16px;
    margin-bottom: 12px;
    color: var(--text);
}

.rules-box ul {
    list-style: none;
}

.rules-box li {
    padding: 8px 0;
    padding-left: 24px;
    position: relative;
    color: var(--text-muted);
    font-size: 14px;
}

.rules-box li:before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: var(--success);
    font-weight: bold;
}

#play-screen {
    padding-top: 60px;
    background: linear-gradient(180deg, var(--bg-dark) 0%, #1a1a3e 100%);
}

.time-bar {
    width: 100%;
    height: 6px;
    background: var(--bg-card);
    position: relative;
    overflow: hidden;
}

.time-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--success) 0%, var(--primary) 50%, var(--danger) 100%);
    width: 100%;
    transition: width 0.1s linear;
}

.score-board {
    text-align: center;
    padding: 30px 20px;
}

.current-score {
    font-size: 72px;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary) 0%, #ffed4e 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
}

.target-display {
    margin-top: 10px;
    color: var(--text-muted);
    font-size: 16px;
}

.combo-display {
    position: absolute;
    top: 120px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    font-size: 36px;
    font-weight: 800;
    color: var(--primary);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    opacity: 0;
    transition: all 0.3s;
    pointer-events: none;
}

.combo-display.show {
    transform: translateX(-50%) scale(1);
    opacity: 1;
}

.game-area {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 300px;
}

.tree-container {
    position: relative;
    width: 120px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 4px;
}

.trunk-section {
    width: 80px;
    height: 60px;
    background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
    border: 3px solid #5D3A1A;
    border-radius: 8px;
    position: relative;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
    from {
        transform: translateY(-20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.branch {
    position: absolute;
    width: 50px;
    height: 16px;
    background: linear-gradient(90deg, #228B22 0%, #32CD32 100%);
    border: 2px solid #006400;
    border-radius: 10px;
    top: 50%;
    transform: translateY(-50%);
}

.branch.left {
    left: -45px;
}

.branch.right {
    right: -45px;
}

.lumberjack {
    position: absolute;
    bottom: -90px;
    width: 70px;
    height: 80px;
    transition: all 0.15s;
    z-index: 10;
}

.lumberjack.left {
    left: -80px;
}

.lumberjack.right {
    right: -80px;
    transform: scaleX(-1);
}

.lumberjack.chopping {
    animation: chopAnim 0.15s ease-out;
}

@keyframes chopAnim {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(-25deg) translateX(-10px); }
    100% { transform: rotate(0deg); }
}

.lumberjack.right.chopping {
    animation: chopAnimRight 0.15s ease-out;
}

@keyframes chopAnimRight {
    0% { transform: scaleX(-1) rotate(0deg); }
    50% { transform: scaleX(-1) rotate(-25deg) translateX(-10px); }
    100% { transform: scaleX(-1) rotate(0deg); }
}

.lumberjack-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #ff6b6b 0%, #c92a2a 100%);
    border-radius: 12px 12px 24px 24px;
    position: relative;
    box-shadow: 0 6px 16px rgba(0,0,0,0.4);
}

.head {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
}

.axe {
    position: absolute;
    right: -25px;
    top: 20px;
    font-size: 30px;
    transform-origin: left center;
}

.game-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, var(--bg-dark) 0%, transparent 100%);
    display: flex;
    gap: 16px;
}

.chop-btn {
    flex: 1;
    height: 80px;
    border: none;
    border-radius: 20px;
    font-size: 36px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.1s;
    box-shadow: 0 8px 0 rgba(0,0,0,0.3), 0 15px 30px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
}

.chop-btn:active {
    transform: translateY(8px);
    box-shadow: 0 0 0 rgba(0,0,0,0.3), 0 5px 15px rgba(0,0,0,0.2);
}

.chop-btn.left {
    background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
    color: white;
}

.chop-btn.right {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
    color: white;
}

.chop-btn:after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.5s;
}

.chop-btn:active:after {
    left: 100%;
}

#result-screen {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    background: var(--bg-dark);
}

.result-content {
    text-align: center;
    width: 100%;
    max-width: 400px;
    animation: fadeInUp 0.5s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.result-icon {
    font-size: 80px;
    margin-bottom: 20px;
}

.result-content h2 {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 24px;
}

.result-content.win h2 {
    color: var(--success);
}

.result-content.lose h2 {
    color: var(--danger);
}

.result-stats {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
}

.stat {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
}

.stat:last-child {
    border-bottom: none;
}

.stat-label {
    color: var(--text-muted);
}

.stat-value {
    font-weight: 700;
    font-size: 18px;
}

.result-message {
    color: var(--text-muted);
    margin-bottom: 24px;
    line-height: 1.6;
}

.result-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

#deposit-screen, #withdraw-screen {
    padding-top: 120px;
}

.deposit-options, .withdraw-options {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.option-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 24px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}

.option-card:active {
    transform: scale(0.98);
    border-color: var(--primary);
    background: var(--bg-hover);
}

.option-icon {
    font-size: 48px;
    margin-bottom: 12px;
}

.option-card h3 {
    font-size: 20px;
    margin-bottom: 8px;
}

.option-card p {
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 8px;
}

.option-card small {
    color: var(--primary);
    font-size: 12px;
    font-weight: 600;
}

#deposit-ton-screen, #deposit-rub-screen,
#withdraw-ton-screen, #withdraw-rub-screen {
    padding-top: 120px;
}

.deposit-form, .withdraw-form {
    padding: 20px;
}

.info-box, .bank-card, .payment-id-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
}

.info-box h4, .payment-id-box h4 {
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.copy-box {
    background: var(--bg-dark);
    border: 2px dashed var(--border);
    border-radius: 12px;
    padding: 16px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
}

.copy-box:active {
    border-color: var(--primary);
    background: var(--bg-hover);
}

.copy-box code {
    display: block;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    word-break: break-all;
    color: var(--primary);
    margin-bottom: 8px;
}

.copy-hint {
    font-size: 12px;
    color: var(--text-muted);
}

.copy-box.important {
    border-color: var(--danger);
    background: rgba(255, 71, 87, 0.05);
}

.copy-box.important code {
    color: var(--danger);
    font-size: 18px;
    font-weight: 700;
}

.bank-card.sbp {
    background: linear-gradient(135deg, #0057b8 0%, #003d82 100%);
    border: none;
}

.bank-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.bank-logo {
    font-weight: 800;
    font-size: 20px;
    color: white;
}

.sbp-badge {
    background: white;
    color: #0057b8;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
}

.bank-phone {
    font-size: 24px;
    font-weight: 700;
    text-align: center;
    cursor: pointer;
    padding: 12px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

.bank-phone small {
    display: block;
    font-size: 12px;
    opacity: 0.8;
    margin-top: 4px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 8px;
}

.form-group input, .form-group select {
    width: 100%;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
    color: var(--text);
    font-size: 16px;
    outline: none;
    transition: all 0.2s;
}

.form-group input:focus, .form-group select:focus {
    border-color: var(--primary);
}

.form-group input::placeholder {
    color: var(--text-muted);
}

.balance-info {
    background: var(--bg-card);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 20px;
    text-align: center;
    color: var(--text-muted);
}

.balance-info strong {
    color: var(--primary);
    font-size: 20px;
}

.hint {
    text-align: center;
    color: var(--text-muted);
    font-size: 13px;
    margin-top: 16px;
    line-height: 1.5;
}

#history-screen {
    padding-top: 120px;
}

.history-tabs {
    display: flex;
    gap: 8px;
    padding: 0 20px;
    margin-bottom: 20px;
    overflow-x: auto;
}

.tab-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
}

.tab-btn.active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.history-list {
    padding: 0 20px;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: var(--text-muted);
}

.history-item {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border: 1px solid var(--border);
}

.history-item .info {
    flex: 1;
}

.history-item .type {
    font-weight: 600;
    margin-bottom: 4px;
}

.history-item .date {
    font-size: 12px;
    color: var(--text-muted);
}

.history-item .amount {
    font-weight: 700;
    font-size: 18px;
}

.history-item .amount.positive {
    color: var(--success);
}

.history-item .amount.negative {
    color: var(--danger);
}

.history-item .status {
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 20px;
    margin-left: 12px;
}

.status.pending {
    background: rgba(255, 215, 0, 0.1);
    color: var(--primary);
}

.status.completed {
    background: rgba(0, 255, 136, 0.1);
    color: var(--success);
}

.status.failed {
    background: rgba(255, 71, 87, 0.1);
    color: var(--danger);
}

.notification {
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-card);
    border: 1px solid var(--border);
    padding: 16px 24px;
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    z-index: 1000;
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

.wood-chip {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #DEB887;
    border-radius: 2px;
    pointer-events: none;
    animation: chipFly 0.5s ease-out forwards;
}

@keyframes chipFly {
    0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translate(var(--tx), var(--ty)) rotate(var(--rot));
        opacity: 0;
    }
}

@media (max-width: 380px) {
    .balance-display {
        gap: 12px;
    }
    
    .balance-item {
        font-size: 12px;
    }
    
    .current-score {
        font-size: 56px;
    }
    
    .chop-btn {
        height: 70px;
        font-size: 28px;
    }
    
    .bet-amount {
        font-size: 36px;
    }
}
    </style>
</head>
<body>
    <div class="header">
        <div class="balance-display">
            <div class="balance-item">
                <span class="icon">üíé</span>
                <span id="balance-ton">0.00</span> TON
            </div>
            <div class="balance-item">
                <span class="icon">‚ÇΩ</span>
                <span id="balance-rub">0</span>
            </div>
        </div>
        <button class="menu-btn" onclick="showScreen('main-screen')">üè†</button>
    </div>

    <div id="main-screen" class="screen active">
        <div class="logo-section">
            <div class="logo-icon">ü™ì</div>
            <h1>TimberTON</h1>
            <p class="subtitle">–†—É–±–∏ –¥–µ—Ä–µ–≤—å—è ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π TON –∏ —Ä—É–±–ª–∏!</p>
        </div>

        <div class="game-preview">
            <div class="preview-tree">üå≤</div>
            <div class="preview-lumberjack">ü™ì</div>
        </div>

        <div class="main-actions">
            <button class="btn btn-primary btn-large" onclick="showScreen('game-menu-screen')">
                üéÆ –ò–ì–†–ê–¢–¨
            </button>
            
            <div class="btn-row">
                <button class="btn btn-secondary" onclick="showScreen('deposit-screen')">
                    üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å
                </button>
                <button class="btn btn-secondary" onclick="showScreen('withdraw-screen')">
                    üí∏ –í—ã–≤–µ—Å—Ç–∏
                </button>
            </div>
            
            <button class="btn btn-info" onclick="showScreen('history-screen')">
                üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä
            </button>
        </div>
    </div>

    <div id="game-menu-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
        </div>

        <div class="bet-container">
            <div class="section">
                <label>–í–∞–ª—é—Ç–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="currency-tabs">
                    <button class="currency-tab active" onclick="selectCurrency('ton')" id="tab-ton">
                        üíé TON
                    </button>
                    <button class="currency-tab" onclick="selectCurrency('rub')" id="tab-rub">
                        ‚ÇΩ –†—É–±–ª–∏
                    </button>
                </div>
            </div>

            <div class="section">
                <label>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="bet-amount" id="bet-display">0.5 TON</div>
                <input type="range" class="bet-slider" id="bet-slider" 
                       min="0.5" max="10" step="0.5" value="0.5" 
                       oninput="updateBet(this.value)">
                <div class="bet-presets">
                    <button onclick="setBet(0.5)">0.5</button>
                    <button onclick="setBet(1)">1</button>
                    <button onclick="setBet(2)">2</button>
                    <button onclick="setBet(5)">5</button>
                    <button onclick="setBet(10)">10</button>
                </div>
            </div>

            <div class="prize-info">
                <div class="prize-card">
                    <div class="prize-label">üéØ –¶–µ–ª—å</div>
                    <div class="prize-value" id="target-score">50 –æ—á–∫–æ–≤</div>
                    <small>–ù–∞–±–µ—Ä–∏ –∑–∞ 30 —Å–µ–∫</small>
                </div>
                <div class="prize-card win">
                    <div class="prize-label">üèÜ –í—ã–∏–≥—Ä—ã—à</div>
                    <div class="prize-value" id="prize-amount">1.0 TON</div>
                    <small>x2 –æ—Ç —Å—Ç–∞–≤–∫–∏</small>
                </div>
            </div>

            <div class="rules-box">
                <h4>üìã –ü—Ä–∞–≤–∏–ª–∞:</h4>
                <ul>
                    <li>–†—É–±–∏ –¥–µ—Ä–µ–≤–æ –∫–Ω–æ–ø–∫–∞–º–∏ ‚Üê ‚Üí</li>
                    <li>–ò–∑–±–µ–≥–∞–π –≤–µ—Ç–æ–∫ ‚Äî –∏–Ω–∞—á–µ –ø—Ä–æ–∏–≥—Ä—ã—à!</li>
                    <li>–ö–∞–∂–¥—ã–π —É–¥–∞—Ä = +1 –æ—á–∫–æ</li>
                    <li>–ù–∞–±–µ—Ä–∏ —Ü–µ–ª—å –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è</li>
                </ul>
            </div>

            <button class="btn btn-primary btn-large" onclick="startGame()">
                ‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨ –ò–ì–†–£
            </button>
        </div>
    </div>

    <div id="play-screen" class="screen">
        <div class="time-bar">
            <div class="time-fill" id="time-fill"></div>
        </div>

        <div class="score-board">
            <div class="current-score" id="current-score">0</div>
            <div class="target-display">–¶–µ–ª—å: <span id="game-target">50</span></div>
        </div>

        <div class="combo-display" id="combo-display">x1</div>

        <div class="game-area">
            <div class="tree-container" id="tree">
                <div class="lumberjack left" id="lumberjack">
                    <div class="lumberjack-body">
                        <div class="head">üë∑</div>
                        <div class="axe">ü™ì</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-controls">
            <button class="chop-btn left" id="btn-left" ontouchstart="event.preventDefault(); chop('left')" onmousedown="chop('left')">‚Üê</button>
            <button class="chop-btn right" id="btn-right" ontouchstart="event.preventDefault(); chop('right')" onmousedown="chop('right')">‚Üí</button>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <div class="result-content" id="result-content">
            <div class="result-icon" id="result-icon">üèÜ</div>
            <h2 id="result-title">–ü–æ–±–µ–¥–∞!</h2>
            
            <div class="result-stats">
                <div class="stat">
                    <span class="stat-label">–û—á–∫–∏:</span>
                    <span class="stat-value" id="result-score">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                    <span class="stat-value" id="result-win">+1.0 TON</span>
                </div>
            </div>

            <div class="result-message" id="result-message">
                –û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!
            </div>

            <div class="result-actions">
                <button class="btn btn-primary" onclick="showScreen('game-menu-screen')">
                    üîÑ –ò–≥—Ä–∞—Ç—å –µ—â—ë
                </button>
                <button class="btn btn-secondary" onclick="showScreen('main-screen')">
                    üè† –í –º–µ–Ω—é
                </button>
            </div>
        </div>
    </div>

    <div id="deposit-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h2>
        </div>

        <div class="deposit-options">
            <div class="option-card" onclick="showScreen('deposit-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h3>
                <p>–û—Ç–ø—Ä–∞–≤—å TON –Ω–∞ –∞–¥—Ä–µ—Å –ø—Ä–æ–µ–∫—Ç–∞</p>
                <small>–ú–∏–Ω–∏–º—É–º: 1 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('deposit-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h3>
                <p>–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –°–ë–ü –Ω–∞ OZON –ë–∞–Ω–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 100 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="deposit-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h2>
        </div>

        <div class="deposit-form">
            <div class="info-box">
                <h4>–ê–¥—Ä–µ—Å –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:</h4>
                <div class="copy-box" onclick="copyToClipboard('UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh')">
                    <code>UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh</code>
                    <span class="copy-hint">üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ TON –æ—Ç–ø—Ä–∞–≤–∏–ª–∏:</label>
                <input type="number" id="deposit-ton-amount" step="0.1" min="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5">
            </div>

            <div class="form-group">
                <label>–í–∞—à TON-–∞–¥—Ä–µ—Å (–¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞):</label>
                <input type="text" id="deposit-ton-from" placeholder="UQ...">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitDeposit('ton')">
                ‚úÖ –Ø –æ—Ç–ø—Ä–∞–≤–∏–ª TON
            </button>
            
            <p class="hint">–ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º</p>
        </div>
    </div>

    <div id="deposit-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>‚ÇΩ –ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h2>
        </div>

        <div class="deposit-form">
            <div class="bank-card sbp">
                <div class="bank-header">
                    <span class="bank-logo">OZON</span>
                    <span class="sbp-badge">–°–ë–ü</span>
                </div>
                <div class="bank-phone" onclick="copyToClipboard('+79941402339')">
                    +7 (994) 140-23-39
                    <small>üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</small>
                </div>
            </div>

            <div class="payment-id-box">
                <h4>–í–∞—à ID –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:</h4>
                <div class="copy-box important" id="payment-id-display" onclick="copyToClipboard(document.getElementById('payment-id-code').textContent)">
                    <code id="payment-id-code">–ó–∞–≥—Ä—É–∑–∫–∞...</code>
                    <span class="copy-hint">‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∂–∏ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏!</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ (‚ÇΩ):</label>
                <input type="number" id="deposit-rub-amount" min="100" step="100" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 500">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitDeposit('rub')">
                ‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–ª
            </button>
            
            <p class="hint">–ü–ª–∞—Ç—ë–∂ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é (5-15 –º–∏–Ω—É—Ç)</p>
        </div>
    </div>

    <div id="withdraw-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h2>
        </div>

        <div class="withdraw-options">
            <div class="option-card" onclick="showScreen('withdraw-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ TON</h3>
                <p>–ù–∞ –≤–∞—à TON-–∫–æ—à–µ–ª—ë–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 5 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('withdraw-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ —Ä—É–±–ª–∏</h3>
                <p>–ù–∞ –∫–∞—Ä—Ç—É —á–µ—Ä–µ–∑ –°–ë–ü</p>
                <small>–ú–∏–Ω–∏–º—É–º: 500 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="withdraw-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>üíé –í—ã–≤–æ–¥ TON</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="withdraw-available-ton">0.00</strong> TON
            </div>

            <div class="form-group">
                <label>TON-–∞–¥—Ä–µ—Å:</label>
                <input type="text" id="withdraw-ton-address" placeholder="UQ... –∏–ª–∏ EQ...">
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞:</label>
                <input type="number" id="withdraw-ton-amount" step="0.1" min="5" placeholder="–ú–∏–Ω–∏–º—É–º 5 TON">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitWithdraw('ton')">
                üöÄ –ó–∞–ø center;
    justify-content: center;
    margin: 20px 0;
}

.preview-tree {
    font-size: 120px;
    position: absolute;
    animation: sway 4s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes sway {
    0%, 100% { transform: rotate(-2deg); }
    50% { transform: rotate(2deg); }
}

.preview-lumberjack {
    font-size: 60px;
    position: absolute;
    bottom: 20px;
    right: 30%;
    animation: chop 1s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes chop {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(-20deg); }
}

.main-actions {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.btn {
    border: none;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.btn:active {
    transform: scale(0.98);
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: #000;
    padding: 18px 32px;
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
}

.btn-primary:active {
    box-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
}

.btn-secondary {
    background: var(--bg-card);
    color: var(--text);
    padding: 16px 24px;
    border: 1px solid var(--border);
}

.btn-secondary:active {
    background: var(--bg-hover);
}

.btn-info {
    background: transparent;
    color: var(--text-muted);
    padding: 14px 24px;
    border: 1px solid var(--border);
}

.btn-large {
    font-size: 18px;
    padding: 20px 40px;
}

.btn-row {
    display: flex;
    gap: 12px;
}

.btn-row .btn {
    flex: 1;
}

.screen-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.95);
    backdrop-filter: blur(10px);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 100;
    border-bottom: 1px solid var(--border);
    padding-top: 60px;
}

.back-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    width: 44px;
    height: 44px;
    border-radius: 12px;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.screen-header h2 {
    font-size: 20px;
    font-weight: 700;
}

#game-menu-screen {
    padding-top: 120px;
}

.bet-container {
    padding: 20px;
}

.section {
    margin-bottom: 24px;
}

.section label {
    display: block;
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 12px;
    font-weight: 500;
}

.currency-tabs {
    display: flex;
    gap: 8px;
    background: var(--bg-card);
    padding: 4px;
    border-radius: 12px;
}

.currency-tab {
    flex: 1;
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 14px;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.currency-tab.active {
    background: var(--primary);
    color: #000;
}

.bet-amount {
    font-size: 48px;
    font-weight: 800;
    text-align: center;
    color: var(--primary);
    margin: 20px 0;
    text-shadow: 0 2px 20px rgba(255, 215, 0, 0.3);
}

.bet-slider {
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: var(--bg-card);
    outline: none;
    -webkit-appearance: none;
    margin: 20px 0;
}

.bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
}

.bet-presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.bet-presets button {
    flex: 1;
    min-width: 60px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.bet-presets button:active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.prize-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 24px 0;
}

.prize-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

.prize-card.win {
    border-color: var(--success);
    background: rgba(0, 255, 136, 0.05);
}

.prize-label {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.prize-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--primary);
}

.prize-card.win .prize-value {
    color: var(--success);
}

.prize-card small {
    display: block;
    margin-top: 8px;
    font-size: 12px;
    color: var(--text-muted);
}

.rules-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin: 24px 0;
}

.rules-box h4 {
    font-size: 16px;
    margin-bottom: 12px;
    color: var(--text);
}

.rules-box ul {
    list-style: none;
}

.rules-box li {
    padding: 8px 0;
    padding-left: 24px;
    position: relative;
    color: var(--text-muted);
    font-size: 14px;
}

.rules-box li:before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: var(--success);
    font-weight: bold;
}

#play-screen {
    padding-top: 60px;
    background: linear-gradient(180deg, var(--bg-dark) 0%, #1a1a3e 100%);
}

.time-bar {
    width: 100%;
    height: 6px;
    background: var(--bg-card);
    position: relative;
    overflow: hidden;
}

.time-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--success) 0%, var(--primary) 50%, var(--danger) 100%);
    width: 100%;
    transition: width 0.1s linear;
}

.score-board {
    text-align: center;
    padding: 30px 20px;
}

.current-score {
    font-size: 72px;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary) 0%, #ffed4e 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
}

.target-display {
    margin-top: 10px;
    color: var(--text-muted);
    font-size: 16px;
}

.combo-display {
    position: absolute;
    top: 120px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    font-size: 36px;
    font-weight: 800;
    color: var(--primary);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    opacity: 0;
    transition: all 0.3s;
    pointer-events: none;
}

.combo-display.show {
    transform: translateX(-50%) scale(1);
    opacity: 1;
}

.game-area {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 300px;
}

.tree-container {
    position: relative;
    width: 120px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 4px;
}

.trunk-section {
    width: 80px;
    height: 60px;
    background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
    border: 3px solid #5D3A1A;
    border-radius: 8px;
    position: relative;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
    from {
        transform: translateY(-20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.branch {
    position: absolute;
    width: 50px;
    height: 16px;
    background: linear-gradient(90deg, #228B22 0%, #32CD32 100%);
    border: 2px solid #006400;
    border-radius: 10px;
    top: 50%;
    transform: translateY(-50%);
}

.branch.left {
    left: -45px;
}

.branch.right {
    right: -45px;
}

.lumberjack {
    position: absolute;
    bottom: -90px;
    width: 70px;
    height: 80px;
    transition: all 0.15s;
    z-index: 10;
}

.lumberjack.left {
    left: -80px;
}

.lumberjack.right {
    right: -80px;
    transform: scaleX(-1);
}

.lumberjack.chopping {
    animation: chopAnim 0.15s ease-out;
}

@keyframes chopAnim {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(-25deg) translateX(-10px); }
    100% { transform: rotate(0deg); }
}

.lumberjack.right.chopping {
    animation: chopAnimRight 0.15s ease-out;
}

@keyframes chopAnimRight {
    0% { transform: scaleX(-1) rotate(0deg); }
    50% { transform: scaleX(-1) rotate(-25deg) translateX(-10px); }
    100% { transform: scaleX(-1) rotate(0deg); }
}

.lumberjack-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #ff6b6b 0%, #c92a2a 100%);
    border-radius: 12px 12px 24px 24px;
    position: relative;
    box-shadow: 0 6px 16px rgba(0,0,0,0.4);
}

.head {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
}

.axe {
    position: absolute;
    right: -25px;
    top: 20px;
    font-size: 30px;
    transform-origin: left center;
}

.game-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, var(--bg-dark) 0%, transparent 100%);
    display: flex;
    gap: 16px;
}

.chop-btn {
    flex: 1;
    height: 80px;
    border: none;
    border-radius: 20px;
    font-size: 36px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.1s;
    box-shadow: 0 8px 0 rgba(0,0,0,0.3), 0 15px 30px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
}

.chop-btn:active {
    transform: translateY(8px);
    box-shadow: 0 0 0 rgba(0,0,0,0.3), 0 5px 15px rgba(0,0,0,0.2);
}

.chop-btn.left {
    background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
    color: white;
}

.chop-btn.right {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
    color: white;
}

.chop-btn:after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.5s;
}

.chop-btn:active:after {
    left: 100%;
}

#result-screen {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    background: var(--bg-dark);
}

.result-content {
    text-align: center;
    width: 100%;
    max-width: 400px;
    animation: fadeInUp 0.5s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.result-icon {
    font-size: 80px;
    margin-bottom: 20px;
}

.result-content h2 {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 24px;
}

.result-content.win h2 {
    color: var(--success);
}

.result-content.lose h2 {
    color: var(--danger);
}

.result-stats {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
}

.stat {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
}

.stat:last-child {
    border-bottom: none;
}

.stat-label {
    color: var(--text-muted);
}

.stat-value {
    font-weight: 700;
    font-size: 18px;
}

.result-message {
    color: var(--text-muted);
    margin-bottom: 24px;
    line-height: 1.6;
}

.result-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

#deposit-screen, #withdraw-screen {
    padding-top: 120px;
}

.deposit-options, .withdraw-options {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.option-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 24px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}

.option-card:active {
    transform: scale(0.98);
    border-color: var(--primary);
    background: var(--bg-hover);
}

.option-icon {
    font-size: 48px;
    margin-bottom: 12px;
}

.option-card h3 {
    font-size: 20px;
    margin-bottom: 8px;
}

.option-card p {
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 8px;
}

.option-card small {
    color: var(--primary);
    font-size: 12px;
    font-weight: 600;
}

#deposit-ton-screen, #deposit-rub-screen,
#withdraw-ton-screen, #withdraw-rub-screen {
    padding-top: 120px;
}

.deposit-form, .withdraw-form {
    padding: 20px;
}

.info-box, .bank-card, .payment-id-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
}

.info-box h4, .payment-id-box h4 {
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.copy-box {
    background: var(--bg-dark);
    border: 2px dashed var(--border);
    border-radius: 12px;
    padding: 16px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
}

.copy-box:active {
    border-color: var(--primary);
    background: var(--bg-hover);
}

.copy-box code {
    display: block;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    word-break: break-all;
    color: var(--primary);
    margin-bottom: 8px;
}

.copy-hint {
    font-size: 12px;
    color: var(--text-muted);
}

.copy-box.important {
    border-color: var(--danger);
    background: rgba(255, 71, 87, 0.05);
}

.copy-box.important code {
    color: var(--danger);
    font-size: 18px;
    font-weight: 700;
}

.bank-card.sbp {
    background: linear-gradient(135deg, #0057b8 0%, #003d82 100%);
    border: none;
}

.bank-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.bank-logo {
    font-weight: 800;
    font-size: 20px;
    color: white;
}

.sbp-badge {
    background: white;
    color: #0057b8;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
}

.bank-phone {
    font-size: 24px;
    font-weight: 700;
    text-align: center;
    cursor: pointer;
    padding: 12px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

.bank-phone small {
    display: block;
    font-size: 12px;
    opacity: 0.8;
    margin-top: 4px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 8px;
}

.form-group input, .form-group select {
    width: 100%;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
    color: var(--text);
    font-size: 16px;
    outline: none;
    transition: all 0.2s;
}

.form-group input:focus, .form-group select:focus {
    border-color: var(--primary);
}

.form-group input::placeholder {
    color: var(--text-muted);
}

.balance-info {
    background: var(--bg-card);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 20px;
    text-align: center;
    color: var(--text-muted);
}

.balance-info strong {
    color: var(--primary);
    font-size: 20px;
}

.hint {
    text-align: center;
    color: var(--text-muted);
    font-size: 13px;
    margin-top: 16px;
    line-height: 1.5;
}

#history-screen {
    padding-top: 120px;
}

.history-tabs {
    display: flex;
    gap: 8px;
    padding: 0 20px;
    margin-bottom: 20px;
    overflow-x: auto;
}

.tab-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
}

.tab-btn.active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.history-list {
    padding: 0 20px;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: var(--text-muted);
}

.history-item {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border: 1px solid var(--border);
}

.history-item .info {
    flex: 1;
}

.history-item .type {
    font-weight: 600;
    margin-bottom: 4px;
}

.history-item .date {
    font-size: 12px;
    color: var(--text-muted);
}

.history-item .amount {
    font-weight: 700;
    font-size: 18px;
}

.history-item .amount.positive {
    color: var(--success);
}

.history-item .amount.negative {
    color: var(--danger);
}

.history-item .status {
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 20px;
    margin-left: 12px;
}

.status.pending {
    background: rgba(255, 215, 0, 0.1);
    color: var(--primary);
}

.status.completed {
    background: rgba(0, 255, 136, 0.1);
    color: var(--success);
}

.status.failed {
    background: rgba(255, 71, 87, 0.1);
    color: var(--danger);
}

.notification {
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-card);
    border: 1px solid var(--border);
    padding: 16px 24px;
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    z-index: 1000;
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

.wood-chip {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #DEB887;
    border-radius: 2px;
    pointer-events: none;
    animation: chipFly 0.5s ease-out forwards;
}

@keyframes chipFly {
    0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translate(var(--tx), var(--ty)) rotate(var(--rot));
        opacity: 0;
    }
}

@media (max-width: 380px) {
    .balance-display {
        gap: 12px;
    }
    
    .balance-item {
        font-size: 12px;
    }
    
    .current-score {
        font-size: 56px;
    }
    
    .chop-btn {
        height: 70px;
        font-size: 28px;
    }
    
    .bet-amount {
        font-size: 36px;
    }
}
    </style>
</head>
<body>
    <div class="header">
        <div class="balance-display">
            <div class="balance-item">
                <span class="icon">üíé</span>
                <span id="balance-ton">0.00</span> TON
            </div>
            <div class="balance-item">
                <span class="icon">‚ÇΩ</span>
                <span id="balance-rub">0</span>
            </div>
        </div>
        <button class="menu-btn" onclick="showScreen('main-screen')">üè†</button>
    </div>

    <div id="main-screen" class="screen active">
        <div class="logo-section">
            <div class="logo-icon">ü™ì</div>
            <h1>TimberTON</h1>
            <p class="subtitle">–†—É–±–∏ –¥–µ—Ä–µ–≤—å—è ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π TON –∏ —Ä—É–±–ª–∏!</p>
        </div>

        <div class="game-preview">
            <div class="preview-tree">üå≤</div>
            <div class="preview-lumberjack">ü™ì</div>
        </div>

        <div class="main-actions">
            <button class="btn btn-primary btn-large" onclick="showScreen('game-menu-screen')">
                üéÆ –ò–ì–†–ê–¢–¨
            </button>
            
            <div class="btn-row">
                <button class="btn btn-secondary" onclick="showScreen('deposit-screen')">
                    üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å
                </button>
                <button class="btn btn-secondary" onclick="showScreen('withdraw-screen')">
                    üí∏ –í—ã–≤–µ—Å—Ç–∏
                </button>
            </div>
            
            <button class="btn btn-info" onclick="showScreen('history-screen')">
                üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä
            </button>
        </div>
    </div>

    <div id="game-menu-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
        </div>

        <div class="bet-container">
            <div class="section">
                <label>–í–∞–ª—é—Ç–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="currency-tabs">
                    <button class="currency-tab active" onclick="selectCurrency('ton')" id="tab-ton">
                        üíé TON
                    </button>
                    <button class="currency-tab" onclick="selectCurrency('rub')" id="tab-rub">
                        ‚ÇΩ –†—É–±–ª–∏
                    </button>
                </div>
            </div>

            <div class="section">
                <label>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="bet-amount" id="bet-display">0.5 TON</div>
                <input type="range" class="bet-slider" id="bet-slider" 
                       min="0.5" max="10" step="0.5" value="0.5" 
                       oninput="updateBet(this.value)">
                <div class="bet-presets">
                    <button onclick="setBet(0.5)">0.5</button>
                    <button onclick="setBet(1)">1</button>
                    <button onclick="setBet(2)">2</button>
                    <button onclick="setBet(5)">5</button>
                    <button onclick="setBet(10)">10</button>
                </div>
            </div>

            <div class="prize-info">
                <div class="prize-card">
                    <div class="prize-label">üéØ –¶–µ–ª—å</div>
                    <div class="prize-value" id="target-score">50 –æ—á–∫–æ–≤</div>
                    <small>–ù–∞–±–µ—Ä–∏ –∑–∞ 30 —Å–µ–∫</small>
                </div>
                <div class="prize-card win">
                    <div class="prize-label">üèÜ –í—ã–∏–≥—Ä—ã—à</div>
                    <div class="prize-value" id="prize-amount">1.0 TON</div>
                    <small>x2 –æ—Ç —Å—Ç–∞–≤–∫–∏</small>
                </div>
            </div>

            <div class="rules-box">
                <h4>üìã –ü—Ä–∞–≤–∏–ª–∞:</h4>
                <ul>
                    <li>–†—É–±–∏ –¥–µ—Ä–µ–≤–æ –∫–Ω–æ–ø–∫–∞–º–∏ ‚Üê ‚Üí</li>
                    <li>–ò–∑–±–µ–≥–∞–π –≤–µ—Ç–æ–∫ ‚Äî –∏–Ω–∞—á–µ –ø—Ä–æ–∏–≥—Ä—ã—à!</li>
                    <li>–ö–∞–∂–¥—ã–π —É–¥–∞—Ä = +1 –æ—á–∫–æ</li>
                    <li>–ù–∞–±–µ—Ä–∏ —Ü–µ–ª—å –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è</li>
                </ul>
            </div>

            <button class="btn btn-primary btn-large" onclick="startGame()">
                ‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨ –ò–ì–†–£
            </button>
        </div>
    </div>

    <div id="play-screen" class="screen">
        <div class="time-bar">
            <div class="time-fill" id="time-fill"></div>
        </div>

        <div class="score-board">
            <div class="current-score" id="current-score">0</div>
            <div class="target-display">–¶–µ–ª—å: <span id="game-target">50</span></div>
        </div>

        <div class="combo-display" id="combo-display">x1</div>

        <div class="game-area">
            <div class="tree-container" id="tree">
                <div class="lumberjack left" id="lumberjack">
                    <div class="lumberjack-body">
                        <div class="head">üë∑</div>
                        <div class="axe">ü™ì</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-controls">
            <button class="chop-btn left" id="btn-left" ontouchstart="event.preventDefault(); chop('left')" onmousedown="chop('left')">‚Üê</button>
            <button class="chop-btn right" id="btn-right" ontouchstart="event.preventDefault(); chop('right')" onmousedown="chop('right')">‚Üí</button>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <div class="result-content" id="result-content">
            <div class="result-icon" id="result-icon">üèÜ</div>
            <h2 id="result-title">–ü–æ–±–µ–¥–∞!</h2>
            
            <div class="result-stats">
                <div class="stat">
                    <span class="stat-label">–û—á–∫–∏:</span>
                    <span class="stat-value" id="result-score">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                    <span class="stat-value" id="result-win">+1.0 TON</span>
                </div>
            </div>

            <div class="result-message" id="result-message">
                –û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!
            </div>

            <div class="result-actions">
                <button class="btn btn-primary" onclick="showScreen('game-menu-screen')">
                    üîÑ –ò–≥—Ä–∞—Ç—å –µ—â—ë
                </button>
                <button class="btn btn-secondary" onclick="showScreen('main-screen')">
                    üè† –í –º–µ–Ω—é
                </button>
            </div>
        </div>
    </div>

    <div id="deposit-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h2>
        </div>

        <div class="deposit-options">
            <div class="option-card" onclick="showScreen('deposit-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h3>
                <p>–û—Ç–ø—Ä–∞–≤—å TON –Ω–∞ –∞–¥—Ä–µ—Å –ø—Ä–æ–µ–∫—Ç–∞</p>
                <small>–ú–∏–Ω–∏–º—É–º: 1 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('deposit-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h3>
                <p>–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –°–ë–ü –Ω–∞ OZON –ë–∞–Ω–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 100 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="deposit-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h2>
        </div>

        <div class="deposit-form">
            <div class="info-box">
                <h4>–ê–¥—Ä–µ—Å –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:</h4>
                <div class="copy-box" onclick="copyToClipboard('UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh')">
                    <code>UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh</code>
                    <span class="copy-hint">üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ TON –æ—Ç–ø—Ä–∞–≤–∏–ª–∏:</label>
                <input type="number" id="deposit-ton-amount" step="0.1" min="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5">
            </div>

            <div class="form-group">
                <label>–í–∞—à TON-–∞–¥—Ä–µ—Å (–¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞):</label>
                <input type="text" id="deposit-ton-from" placeholder="UQ...">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitDeposit('ton')">
                ‚úÖ –Ø –æ—Ç–ø—Ä–∞–≤–∏–ª TON
            </button>
            
            <p class="hint">–ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º</p>
        </div>
    </div>

    <div id="deposit-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>‚ÇΩ –ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h2>
        </div>

        <div class="deposit-form">
            <div class="bank-card sbp">
                <div class="bank-header">
                    <span class="bank-logo">OZON</span>
                    <span class="sbp-badge">–°–ë–ü</span>
                </div>
                <div class="bank-phone" onclick="copyToClipboard('+79941402339')">
                    +7 (994) 140-23-39
                    <small>üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</small>
                </div>
            </div>

            <div class="payment-id-box">
                <h4>–í–∞—à ID –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:</h4>
                <div class="copy-box important" id="payment-id-display" onclick="copyToClipboard(document.getElementById('payment-id-code').textContent)">
                    <code id="payment-id-code">–ó–∞–≥—Ä—É–∑–∫–∞...</code>
                    <span class="copy-hint">‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∂–∏ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏!</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ (‚ÇΩ):</label>
                <input type="number" id="deposit-rub-amount" min="100" step="100" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 500">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitDeposit('rub')">
                ‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–ª
            </button>
            
            <p class="hint">–ü–ª–∞—Ç—ë–∂ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é (5-15 –º–∏–Ω—É—Ç)</p>
        </div>
    </div>

    <div id="withdraw-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h2>
        </div>

        <div class="withdraw-options">
            <div class="option-card" onclick="showScreen('withdraw-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ TON</h3>
                <p>–ù–∞ –≤–∞—à TON-–∫–æ—à–µ–ª—ë–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 5 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('withdraw-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ —Ä—É–±–ª–∏</h3>
                <p>–ù–∞ –∫–∞—Ä—Ç—É —á–µ—Ä–µ–∑ –°–ë–ü</p>
                <small>–ú–∏–Ω–∏–º—É–º: 500 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="withdraw-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>üíé –í—ã–≤–æ–¥ TON</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="withdraw-available-ton">0.00</strong> TON
            </div>

            <div class="form-group">
                <label>TON-–∞–¥—Ä–µ—Å:</label>
                <input type="text" id="withdraw-ton-address" placeholder="UQ... –∏–ª–∏ EQ...">
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞:</label>
                <input type="number" id="withdraw-ton-amount" step="0.1" min="5" placeholder="–ú–∏–Ω–∏–º—É–º 5 TON">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitWithdraw('ton')">
                üöÄ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥
            </button>
            
            <p class="hint">–û–±—Ä–∞–±–æ—Ç–∫–∞: –¥–æ 24 —á–∞—Å–æ–≤. –ö–æ–º–∏—Å—Å–∏—è: 0%</p>
        </div>
    </div>

    <div id="withdraw-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>‚ÇΩ –í—ã–≤–æ–¥ —Ä—É–±–ª–µ–π</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="withdraw-available-rub">0</strong> ‚ÇΩ
            </div>

            <div class="form-group">
                <label>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–°–ë–ü):</label>
                <input type="tel" id="withdraw-rub-phone" placeholder="+7 (999) 123-45-67">
            </div>

            <div class="form-group">
                <label>–ë–∞–Ω–∫:</label>
                <select id="withdraw-rub-bank">
                    <option value="–°–±–µ—Ä–±–∞–Ω–∫">üè¶ –°–±–µ—Ä–±–∞–Ω–∫</option>
                    <option value="–¢–∏–Ω—å–∫–æ—Ñ—Ñ">üü° –¢–∏–Ω—å–∫–æ—Ñ—Ñ</option>
                    <option value="–í–¢–ë">üîµ –í–¢–ë</option>
                    <option value="–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫">üü£ –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫</option>
                    <option value="–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω">üü¢ –†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω</option>
                    <option value="–î—Ä—É–≥–æ–π">‚ö™ –î—Ä—É–≥–æ–π</option>
                </select>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ (‚ÇΩ):</label>
                <input type="number" id="withdraw-rub-amount" min="500" step="100" placeholder="–ú–∏–Ω–∏–º—É–º 500 ‚ÇΩ">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitWithdraw('rub')">
                üöÄ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥
            </button>
            
            <p class="hint">–û–±—Ä–∞–±–æ—Ç–∫–∞: –¥–æ 24 —á–∞—Å–æ–≤. –ö–æ–º–∏—Å—Å–∏—è: 0%</p>
        </div>
    </div>

    <div id="history-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üìä –ò—Å—Ç–æ—Ä–∏—è</h2>
        </div>

        <div class="history-tabs">
            <button class="tab-btn active" onclick="showHistoryTab('games')" id="tab-games">üéÆ –ò–≥—Ä—ã</button>
            <button class="tab-btn" onclick="showHistoryTab('deposits')" id="tab-deposits">üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è</button>
            <button class="tab-btn" onclick="showHistoryTab('withdrawals')" id="tab-withdrawals">üí∏ –í—ã–≤–æ–¥—ã</button>
        </div>

        <div class="history-list" id="history-list">
            <div class="empty-state">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
    </div>

    <div id="notification" class="notification hidden">
        <span id="notification-text"></span>
    </div>

    <script>
const tg = window.Telegram.WebApp;
tg.expand();
tg.ready();

const API_URL = '';

let currentUser = {
    id: tg.initDataUnsafe?.user?.id?.toString() || 'demo_' + Date.now(),
    username: tg.initDataUnsafe?.user?.username || 'demo',
    balance_ton: 0,
    balance_rub: 0
};

let gameState = {
    isPlaying: false,
    score: 0,
    targetScore: 50,
    timeLeft: 30,
    maxTime: 30,
    combo: 0,
    position: 'left',
    treeSections: [],
    bet: 0.5,
    currency: 'ton',
    gameId: null,
    timer: null
};

let currentHistoryTab = 'games';

function showScreen(screenId) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    const screen = document.getElementById(screenId);
    if (screen) {
        screen.classList.add('active');
    }
    
    if (screenId === 'main-screen') {
        updateBalanceDisplay();
    } else if (screenId === 'deposit-rub-screen') {
        generatePaymentId();
    } else if (screenId === 'withdraw-ton-screen') {
        document.getElementById('withdraw-available-ton').textContent = currentUser.balance_ton.toFixed(2);
    } else if (screenId === 'withdraw-rub-screen') {
        document.getElementById('withdraw-available-rub').textContent = currentUser.balance_rub;
    } else if (screenId === 'history-screen') {
        loadHistory();
    }
}

function selectCurrency(currency) {
    gameState.currency = currency;
    document.querySelectorAll('.currency-tab').forEach(t => t.classList.remove('active'));
    document.getElementById('tab-' + currency).classList.add('active');
    
    const isTon = currency === 'ton';
    const minBet = isTon ? 0.5 : 50;
    const maxBet = isTon ? 10 : 1000;
    const step = isTon ? 0.5 : 50;
    
    const slider = document.getElementById('bet-slider');
    slider.min = minBet;
    slider.max = maxBet;
    slider.step = step;
    slider.value = minBet;
    
    updateBet(minBet);
    
    const presets = document.querySelector('.bet-presets');
    presets.innerHTML = '';
    const values = isTon ? [0.5, 1, 2, 5, 10] : [50, 100, 250, 500, 1000];
    values.forEach(v => {
        const btn = document.createElement('button');
        btn.textContent = v;
        btn.onclick = function() { setBet(v); };
        presets.appendChild(btn);
    });
}

function updateBet(value) {
    gameState.bet = parseFloat(value);
    const isTon = gameState.currency === 'ton';
    const symbol = isTon ? ' TON' : ' ‚ÇΩ';
    document.getElementById('bet-display').textContent = value + symbol;
    
    const target = Math.floor(30 + (gameState.bet * (isTon ? 20 : 0.4)));
    gameState.targetScore = target;
    document.getElementById('target-score').textContent = target + ' –æ—á–∫–æ–≤';
    
    const prize = gameState.bet * 2;
    document.getElementById('prize-amount').textContent = prize + symbol;
}

function setBet(value) {
    document.getElement center;
    justify-content: center;
    margin: 20px 0;
}

.preview-tree {
    font-size: 120px;
    position: absolute;
    animation: sway 4s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes sway {
    0%, 100% { transform: rotate(-2deg); }
    50% { transform: rotate(2deg); }
}

.preview-lumberjack {
    font-size: 60px;
    position: absolute;
    bottom: 20px;
    right: 30%;
    animation: chop 1s ease-in-out infinite;
    transform-origin: bottom center;
}

@keyframes chop {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(-20deg); }
}

.main-actions {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.btn {
    border: none;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.btn:active {
    transform: scale(0.98);
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: #000;
    padding: 18px 32px;
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
}

.btn-primary:active {
    box-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
}

.btn-secondary {
    background: var(--bg-card);
    color: var(--text);
    padding: 16px 24px;
    border: 1px solid var(--border);
}

.btn-secondary:active {
    background: var(--bg-hover);
}

.btn-info {
    background: transparent;
    color: var(--text-muted);
    padding: 14px 24px;
    border: 1px solid var(--border);
}

.btn-large {
    font-size: 18px;
    padding: 20px 40px;
}

.btn-row {
    display: flex;
    gap: 12px;
}

.btn-row .btn {
    flex: 1;
}

.screen-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.95);
    backdrop-filter: blur(10px);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 100;
    border-bottom: 1px solid var(--border);
    padding-top: 60px;
}

.back-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    width: 44px;
    height: 44px;
    border-radius: 12px;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.screen-header h2 {
    font-size: 20px;
    font-weight: 700;
}

#game-menu-screen {
    padding-top: 120px;
}

.bet-container {
    padding: 20px;
}

.section {
    margin-bottom: 24px;
}

.section label {
    display: block;
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 12px;
    font-weight: 500;
}

.currency-tabs {
    display: flex;
    gap: 8px;
    background: var(--bg-card);
    padding: 4px;
    border-radius: 12px;
}

.currency-tab {
    flex: 1;
    background: transparent;
    border: none;
    color: var(--text-muted);
    padding: 14px;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.currency-tab.active {
    background: var(--primary);
    color: #000;
}

.bet-amount {
    font-size: 48px;
    font-weight: 800;
    text-align: center;
    color: var(--primary);
    margin: 20px 0;
    text-shadow: 0 2px 20px rgba(255, 215, 0, 0.3);
}

.bet-slider {
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: var(--bg-card);
    outline: none;
    -webkit-appearance: none;
    margin: 20px 0;
}

.bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
}

.bet-presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.bet-presets button {
    flex: 1;
    min-width: 60px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.bet-presets button:active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.prize-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 24px 0;
}

.prize-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

.prize-card.win {
    border-color: var(--success);
    background: rgba(0, 255, 136, 0.05);
}

.prize-label {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.prize-value {
    font-size: 24px;
    font-weight: 700;
    color: var(--primary);
}

.prize-card.win .prize-value {
    color: var(--success);
}

.prize-card small {
    display: block;
    margin-top: 8px;
    font-size: 12px;
    color: var(--text-muted);
}

.rules-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin: 24px 0;
}

.rules-box h4 {
    font-size: 16px;
    margin-bottom: 12px;
    color: var(--text);
}

.rules-box ul {
    list-style: none;
}

.rules-box li {
    padding: 8px 0;
    padding-left: 24px;
    position: relative;
    color: var(--text-muted);
    font-size: 14px;
}

.rules-box li:before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: var(--success);
    font-weight: bold;
}

#play-screen {
    padding-top: 60px;
    background: linear-gradient(180deg, var(--bg-dark) 0%, #1a1a3e 100%);
}

.time-bar {
    width: 100%;
    height: 6px;
    background: var(--bg-card);
    position: relative;
    overflow: hidden;
}

.time-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--success) 0%, var(--primary) 50%, var(--danger) 100%);
    width: 100%;
    transition: width 0.1s linear;
}

.score-board {
    text-align: center;
    padding: 30px 20px;
}

.current-score {
    font-size: 72px;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary) 0%, #ffed4e 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
}

.target-display {
    margin-top: 10px;
    color: var(--text-muted);
    font-size: 16px;
}

.combo-display {
    position: absolute;
    top: 120px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    font-size: 36px;
    font-weight: 800;
    color: var(--primary);
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    opacity: 0;
    transition: all 0.3s;
    pointer-events: none;
}

.combo-display.show {
    transform: translateX(-50%) scale(1);
    opacity: 1;
}

.game-area {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 300px;
}

.tree-container {
    position: relative;
    width: 120px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 4px;
}

.trunk-section {
    width: 80px;
    height: 60px;
    background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
    border: 3px solid #5D3A1A;
    border-radius: 8px;
    position: relative;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
    from {
        transform: translateY(-20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.branch {
    position: absolute;
    width: 50px;
    height: 16px;
    background: linear-gradient(90deg, #228B22 0%, #32CD32 100%);
    border: 2px solid #006400;
    border-radius: 10px;
    top: 50%;
    transform: translateY(-50%);
}

.branch.left {
    left: -45px;
}

.branch.right {
    right: -45px;
}

.lumberjack {
    position: absolute;
    bottom: -90px;
    width: 70px;
    height: 80px;
    transition: all 0.15s;
    z-index: 10;
}

.lumberjack.left {
    left: -80px;
}

.lumberjack.right {
    right: -80px;
    transform: scaleX(-1);
}

.lumberjack.chopping {
    animation: chopAnim 0.15s ease-out;
}

@keyframes chopAnim {
    0% { transform: rotate(0deg); }
    50% { transform: rotate(-25deg) translateX(-10px); }
    100% { transform: rotate(0deg); }
}

.lumberjack.right.chopping {
    animation: chopAnimRight 0.15s ease-out;
}

@keyframes chopAnimRight {
    0% { transform: scaleX(-1) rotate(0deg); }
    50% { transform: scaleX(-1) rotate(-25deg) translateX(-10px); }
    100% { transform: scaleX(-1) rotate(0deg); }
}

.lumberjack-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #ff6b6b 0%, #c92a2a 100%);
    border-radius: 12px 12px 24px 24px;
    position: relative;
    box-shadow: 0 6px 16px rgba(0,0,0,0.4);
}

.head {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
}

.axe {
    position: absolute;
    right: -25px;
    top: 20px;
    font-size: 30px;
    transform-origin: left center;
}

.game-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, var(--bg-dark) 0%, transparent 100%);
    display: flex;
    gap: 16px;
}

.chop-btn {
    flex: 1;
    height: 80px;
    border: none;
    border-radius: 20px;
    font-size: 36px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.1s;
    box-shadow: 0 8px 0 rgba(0,0,0,0.3), 0 15px 30px rgba(0,0,0,0.3);
    position: relative;
    overflow: hidden;
}

.chop-btn:active {
    transform: translateY(8px);
    box-shadow: 0 0 0 rgba(0,0,0,0.3), 0 5px 15px rgba(0,0,0,0.2);
}

.chop-btn.left {
    background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
    color: white;
}

.chop-btn.right {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
    color: white;
}

.chop-btn:after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.5s;
}

.chop-btn:active:after {
    left: 100%;
}

#result-screen {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    background: var(--bg-dark);
}

.result-content {
    text-align: center;
    width: 100%;
    max-width: 400px;
    animation: fadeInUp 0.5s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.result-icon {
    font-size: 80px;
    margin-bottom: 20px;
}

.result-content h2 {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 24px;
}

.result-content.win h2 {
    color: var(--success);
}

.result-content.lose h2 {
    color: var(--danger);
}

.result-stats {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
}

.stat {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
}

.stat:last-child {
    border-bottom: none;
}

.stat-label {
    color: var(--text-muted);
}

.stat-value {
    font-weight: 700;
    font-size: 18px;
}

.result-message {
    color: var(--text-muted);
    margin-bottom: 24px;
    line-height: 1.6;
}

.result-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

#deposit-screen, #withdraw-screen {
    padding-top: 120px;
}

.deposit-options, .withdraw-options {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.option-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 24px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}

.option-card:active {
    transform: scale(0.98);
    border-color: var(--primary);
    background: var(--bg-hover);
}

.option-icon {
    font-size: 48px;
    margin-bottom: 12px;
}

.option-card h3 {
    font-size: 20px;
    margin-bottom: 8px;
}

.option-card p {
    color: var(--text-muted);
    font-size: 14px;
    margin-bottom: 8px;
}

.option-card small {
    color: var(--primary);
    font-size: 12px;
    font-weight: 600;
}

#deposit-ton-screen, #deposit-rub-screen,
#withdraw-ton-screen, #withdraw-rub-screen {
    padding-top: 120px;
}

.deposit-form, .withdraw-form {
    padding: 20px;
}

.info-box, .bank-card, .payment-id-box {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
}

.info-box h4, .payment-id-box h4 {
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.copy-box {
    background: var(--bg-dark);
    border: 2px dashed var(--border);
    border-radius: 12px;
    padding: 16px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
}

.copy-box:active {
    border-color: var(--primary);
    background: var(--bg-hover);
}

.copy-box code {
    display: block;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    word-break: break-all;
    color: var(--primary);
    margin-bottom: 8px;
}

.copy-hint {
    font-size: 12px;
    color: var(--text-muted);
}

.copy-box.important {
    border-color: var(--danger);
    background: rgba(255, 71, 87, 0.05);
}

.copy-box.important code {
    color: var(--danger);
    font-size: 18px;
    font-weight: 700;
}

.bank-card.sbp {
    background: linear-gradient(135deg, #0057b8 0%, #003d82 100%);
    border: none;
}

.bank-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.bank-logo {
    font-weight: 800;
    font-size: 20px;
    color: white;
}

.sbp-badge {
    background: white;
    color: #0057b8;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
}

.bank-phone {
    font-size: 24px;
    font-weight: 700;
    text-align: center;
    cursor: pointer;
    padding: 12px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

.bank-phone small {
    display: block;
    font-size: 12px;
    opacity: 0.8;
    margin-top: 4px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-size: 14px;
    color: var(--text-muted);
    margin-bottom: 8px;
}

.form-group input, .form-group select {
    width: 100%;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
    color: var(--text);
    font-size: 16px;
    outline: none;
    transition: all 0.2s;
}

.form-group input:focus, .form-group select:focus {
    border-color: var(--primary);
}

.form-group input::placeholder {
    color: var(--text-muted);
}

.balance-info {
    background: var(--bg-card);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 20px;
    text-align: center;
    color: var(--text-muted);
}

.balance-info strong {
    color: var(--primary);
    font-size: 20px;
}

.hint {
    text-align: center;
    color: var(--text-muted);
    font-size: 13px;
    margin-top: 16px;
    line-height: 1.5;
}

#history-screen {
    padding-top: 120px;
}

.history-tabs {
    display: flex;
    gap: 8px;
    padding: 0 20px;
    margin-bottom: 20px;
    overflow-x: auto;
}

.tab-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
}

.tab-btn.active {
    background: var(--primary);
    color: #000;
    border-color: var(--primary);
}

.history-list {
    padding: 0 20px;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: var(--text-muted);
}

.history-item {
    background: var(--bg-card);
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border: 1px solid var(--border);
}

.history-item .info {
    flex: 1;
}

.history-item .type {
    font-weight: 600;
    margin-bottom: 4px;
}

.history-item .date {
    font-size: 12px;
    color: var(--text-muted);
}

.history-item .amount {
    font-weight: 700;
    font-size: 18px;
}

.history-item .amount.positive {
    color: var(--success);
}

.history-item .amount.negative {
    color: var(--danger);
}

.history-item .status {
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 20px;
    margin-left: 12px;
}

.status.pending {
    background: rgba(255, 215, 0, 0.1);
    color: var(--primary);
}

.status.completed {
    background: rgba(0, 255, 136, 0.1);
    color: var(--success);
}

.status.failed {
    background: rgba(255, 71, 87, 0.1);
    color: var(--danger);
}

.notification {
    position: fixed;
    top: 80px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-card);
    border: 1px solid var(--border);
    padding: 16px 24px;
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    z-index: 1000;
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

.wood-chip {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #DEB887;
    border-radius: 2px;
    pointer-events: none;
    animation: chipFly 0.5s ease-out forwards;
}

@keyframes chipFly {
    0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translate(var(--tx), var(--ty)) rotate(var(--rot));
        opacity: 0;
    }
}

@media (max-width: 380px) {
    .balance-display {
        gap: 12px;
    }
    
    .balance-item {
        font-size: 12px;
    }
    
    .current-score {
        font-size: 56px;
    }
    
    .chop-btn {
        height: 70px;
        font-size: 28px;
    }
    
    .bet-amount {
        font-size: 36px;
    }
}
    </style>
</head>
<body>
    <div class="header">
        <div class="balance-display">
            <div class="balance-item">
                <span class="icon">üíé</span>
                <span id="balance-ton">0.00</span> TON
            </div>
            <div class="balance-item">
                <span class="icon">‚ÇΩ</span>
                <span id="balance-rub">0</span>
            </div>
        </div>
        <button class="menu-btn" onclick="showScreen('main-screen')">üè†</button>
    </div>

    <div id="main-screen" class="screen active">
        <div class="logo-section">
            <div class="logo-icon">ü™ì</div>
            <h1>TimberTON</h1>
            <p class="subtitle">–†—É–±–∏ –¥–µ—Ä–µ–≤—å—è ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π TON –∏ —Ä—É–±–ª–∏!</p>
        </div>

        <div class="game-preview">
            <div class="preview-tree">üå≤</div>
            <div class="preview-lumberjack">ü™ì</div>
        </div>

        <div class="main-actions">
            <button class="btn btn-primary btn-large" onclick="showScreen('game-menu-screen')">
                üéÆ –ò–ì–†–ê–¢–¨
            </button>
            
            <div class="btn-row">
                <button class="btn btn-secondary" onclick="showScreen('deposit-screen')">
                    üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å
                </button>
                <button class="btn btn-secondary" onclick="showScreen('withdraw-screen')">
                    üí∏ –í—ã–≤–µ—Å—Ç–∏
                </button>
            </div>
            
            <button class="btn btn-info" onclick="showScreen('history-screen')">
                üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä
            </button>
        </div>
    </div>

    <div id="game-menu-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
        </div>

        <div class="bet-container">
            <div class="section">
                <label>–í–∞–ª—é—Ç–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="currency-tabs">
                    <button class="currency-tab active" onclick="selectCurrency('ton')" id="tab-ton">
                        üíé TON
                    </button>
                    <button class="currency-tab" onclick="selectCurrency('rub')" id="tab-rub">
                        ‚ÇΩ –†—É–±–ª–∏
                    </button>
                </div>
            </div>

            <div class="section">
                <label>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="bet-amount" id="bet-display">0.5 TON</div>
                <input type="range" class="bet-slider" id="bet-slider" 
                       min="0.5" max="10" step="0.5" value="0.5" 
                       oninput="updateBet(this.value)">
                <div class="bet-presets">
                    <button onclick="setBet(0.5)">0.5</button>
                    <button onclick="setBet(1)">1</button>
                    <button onclick="setBet(2)">2</button>
                    <button onclick="setBet(5)">5</button>
                    <button onclick="setBet(10)">10</button>
                </div>
            </div>

            <div class="prize-info">
                <div class="prize-card">
                    <div class="prize-label">üéØ –¶–µ–ª—å</div>
                    <div class="prize-value" id="target-score">50 –æ—á–∫–æ–≤</div>
                    <small>–ù–∞–±–µ—Ä–∏ –∑–∞ 30 —Å–µ–∫</small>
                </div>
                <div class="prize-card win">
                    <div class="prize-label">üèÜ –í—ã–∏–≥—Ä—ã—à</div>
                    <div class="prize-value" id="prize-amount">1.0 TON</div>
                    <small>x2 –æ—Ç —Å—Ç–∞–≤–∫–∏</small>
                </div>
            </div>

            <div class="rules-box">
                <h4>üìã –ü—Ä–∞–≤–∏–ª–∞:</h4>
                <ul>
                    <li>–†—É–±–∏ –¥–µ—Ä–µ–≤–æ –∫–Ω–æ–ø–∫–∞–º–∏ ‚Üê ‚Üí</li>
                    <li>–ò–∑–±–µ–≥–∞–π –≤–µ—Ç–æ–∫ ‚Äî –∏–Ω–∞—á–µ –ø—Ä–æ–∏–≥—Ä—ã—à!</li>
                    <li>–ö–∞–∂–¥—ã–π —É–¥–∞—Ä = +1 –æ—á–∫–æ</li>
                    <li>–ù–∞–±–µ—Ä–∏ —Ü–µ–ª—å –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è</li>
                </ul>
            </div>

            <button class="btn btn-primary btn-large" onclick="startGame()">
                ‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨ –ò–ì–†–£
            </button>
        </div>
    </div>

    <div id="play-screen" class="screen">
        <div class="time-bar">
            <div class="time-fill" id="time-fill"></div>
        </div>

        <div class="score-board">
            <div class="current-score" id="current-score">0</div>
            <div class="target-display">–¶–µ–ª—å: <span id="game-target">50</span></div>
        </div>

        <div class="combo-display" id="combo-display">x1</div>

        <div class="game-area">
            <div class="tree-container" id="tree">
                <div class="lumberjack left" id="lumberjack">
                    <div class="lumberjack-body">
                        <div class="head">üë∑</div>
                        <div class="axe">ü™ì</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-controls">
            <button class="chop-btn left" id="btn-left" ontouchstart="event.preventDefault(); chop('left')" onmousedown="chop('left')">‚Üê</button>
            <button class="chop-btn right" id="btn-right" ontouchstart="event.preventDefault(); chop('right')" onmousedown="chop('right')">‚Üí</button>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <div class="result-content" id="result-content">
            <div class="result-icon" id="result-icon">üèÜ</div>
            <h2 id="result-title">–ü–æ–±–µ–¥–∞!</h2>
            
            <div class="result-stats">
                <div class="stat">
                    <span class="stat-label">–û—á–∫–∏:</span>
                    <span class="stat-value" id="result-score">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                    <span class="stat-value" id="result-win">+1.0 TON</span>
                </div>
            </div>

            <div class="result-message" id="result-message">
                –û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!
            </div>

            <div class="result-actions">
                <button class="btn btn-primary" onclick="showScreen('game-menu-screen')">
                    üîÑ –ò–≥—Ä–∞—Ç—å –µ—â—ë
                </button>
                <button class="btn btn-secondary" onclick="showScreen('main-screen')">
                    üè† –í –º–µ–Ω—é
                </button>
            </div>
        </div>
    </div>

    <div id="deposit-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h2>
        </div>

        <div class="deposit-options">
            <div class="option-card" onclick="showScreen('deposit-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h3>
                <p>–û—Ç–ø—Ä–∞–≤—å TON –Ω–∞ –∞–¥—Ä–µ—Å –ø—Ä–æ–µ–∫—Ç–∞</p>
                <small>–ú–∏–Ω–∏–º—É–º: 1 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('deposit-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h3>
                <p>–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –°–ë–ü –Ω–∞ OZON –ë–∞–Ω–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 100 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="deposit-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h2>
        </div>

        <div class="deposit-form">
            <div class="info-box">
                <h4>–ê–¥—Ä–µ—Å –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:</h4>
                <div class="copy-box" onclick="copyToClipboard('UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh')">
                    <code>UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh</code>
                    <span class="copy-hint">üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ TON –æ—Ç–ø—Ä–∞–≤–∏–ª–∏:</label>
                <input type="number" id="deposit-ton-amount" step="0.1" min="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5">
            </div>

            <div class="form-group">
                <label>–í–∞—à TON-–∞–¥—Ä–µ—Å (–¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞):</label>
                <input type="text" id="deposit-ton-from" placeholder="UQ...">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitDeposit('ton')">
                ‚úÖ –Ø –æ—Ç–ø—Ä–∞–≤–∏–ª TON
            </button>
            
            <p class="hint">–ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º</p>
        </div>
    </div>

    <div id="deposit-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>‚ÇΩ –ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h2>
        </div>

        <div class="deposit-form">
            <div class="bank-card sbp">
                <div class="bank-header">
                    <span class="bank-logo">OZON</span>
                    <span class="sbp-badge">–°–ë–ü</span>
                </div>
                <div class="bank-phone" onclick="copyToClipboard('+79941402339')">
                    +7 (994) 140-23-39
                    <small>üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</small>
                </div>
            </div>

            <div class="payment-id-box">
                <h4>–í–∞—à ID –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:</h4>
                <div class="copy-box important" id="payment-id-display" onclick="copyToClipboard(document.getElementById('payment-id-code').textContent)">
                    <code id="payment-id-code">–ó–∞–≥—Ä—É–∑–∫–∞...</code>
                    <span class="copy-hint">‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∂–∏ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏!</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ (‚ÇΩ):</label>
                <input type="number" id="deposit-rub-amount" min="100" step="100" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 500">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitDeposit('rub')">
                ‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–ª
            </button>
            
            <p class="hint">–ü–ª–∞—Ç—ë–∂ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é (5-15 –º–∏–Ω—É—Ç)</p>
        </div>
    </div>

    <div id="withdraw-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h2>
        </div>

        <div class="withdraw-options">
            <div class="option-card" onclick="showScreen('withdraw-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ TON</h3>
                <p>–ù–∞ –≤–∞—à TON-–∫–æ—à–µ–ª—ë–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 5 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('withdraw-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ —Ä—É–±–ª–∏</h3>
                <p>–ù–∞ –∫–∞—Ä—Ç—É —á–µ—Ä–µ–∑ –°–ë–ü</p>
                <small>–ú–∏–Ω–∏–º—É–º: 500 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="withdraw-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>üíé –í—ã–≤–æ–¥ TON</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="withdraw-available-ton">0.00</strong> TON
            </div>

            <div class="form-group">
                <label>TON-–∞–¥—Ä–µ—Å:</label>
                <input type="text" id="withdraw-ton-address" placeholder="UQ... –∏–ª–∏ EQ...">
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞:</label>
                <input type="number" id="withdraw-ton-amount" step="0.1" min="5" placeholder="–ú–∏–Ω–∏–º—É–º 5 TON">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitWithdraw('ton')">
                üöÄ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥
            </button>
            
            <p class="hint">–û–±—Ä–∞–±–æ—Ç–∫–∞: –¥–æ 24 —á–∞—Å–æ–≤. –ö–æ–º–∏—Å—Å–∏—è: 0%</p>
        </div>
    </div>

    <div id="withdraw-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>‚ÇΩ –í—ã–≤–æ–¥ —Ä—É–±–ª–µ–π</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="withdraw-available-rub">0</strong> ‚ÇΩ
            </div>

            <div class="form-group">
                <label>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–°–ë–ü):</label>
                <input type="tel" id="withdraw-rub-phone" placeholder="+7 (999) 123-45-67">
            </div>

            <div class="form-group">
                <label>–ë–∞–Ω–∫:</label>
                <select id="withdraw-rub-bank">
                    <option value="–°–±–µ—Ä–±–∞–Ω–∫">üè¶ –°–±–µ—Ä–±–∞–Ω–∫</option>
                    <option value="–¢–∏–Ω—å–∫–æ—Ñ—Ñ">üü° –¢–∏–Ω—å–∫–æ—Ñ—Ñ</option>
                    <option value="–í–¢–ë">üîµ –í–¢–ë</option>
                    <option value="–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫">üü£ –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫</option>
                    <option value="–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω">üü¢ –†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω</option>
                    <option value="–î—Ä—É–≥–æ–π">‚ö™ –î—Ä—É–≥–æ–π</option>
                </select>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ (‚ÇΩ):</label>
                <input type="number" id="withdraw-rub-amount" min="500" step="100" placeholder="–ú–∏–Ω–∏–º—É–º 500 ‚ÇΩ">
            </div>

            <button class="btn btn-primary btn-large" onclick="submitWithdraw('rub')">
                üöÄ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥
            </button>
            
            <p class="hint">–û–±—Ä–∞–±–æ—Ç–∫–∞: –¥–æ 24 —á–∞—Å–æ–≤. –ö–æ–º–∏—Å—Å–∏—è: 0%</p>
        </div>
    </div>

    <div id="history-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('main-screen')">‚Üê</button>
            <h2>üìä –ò—Å—Ç–æ—Ä–∏—è</h2>
        </div>

        <div class="history-tabs">
            <button class="tab-btn active" onclick="showHistoryTab('games')" id="tab-games">üéÆ –ò–≥—Ä—ã</button>
            <button class="tab-btn" onclick="showHistoryTab('deposits')" id="tab-deposits">üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è</button>
            <button class="tab-btn" onclick="showHistoryTab('withdrawals')" id="tab-withdrawals">üí∏ –í—ã–≤–æ–¥—ã</button>
        </div>

        <div class="history-list" id="history-list">
            <div class="empty-state">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
    </div>

    <div id="notification" class="notification hidden">
        <span id="notification-text"></span>
    </div>

    <script>
const tg = window.Telegram.WebApp;
tg.expand();
tg.ready();

const API_URL = '';

let currentUser = {
    id: tg.initDataUnsafe?.user?.id?.toString() || 'demo_' + Date.now(),
    username: tg.initDataUnsafe?.user?.username || 'demo',
    balance_ton: 0,
    balance_rub: 0
};

let gameState = {
    isPlaying: false,
    score: 0,
    targetScore: 50,
    timeLeft: 30,
    maxTime: 30,
    combo: 0,
    position: 'left',
    treeSections: [],
    bet: 0.5,
    currency: 'ton',
    gameId: null,
    timer: null
};

let currentHistoryTab = 'games';

function showScreen(screenId) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    const screen = document.getElementById(screenId);
    if (screen) {
        screen.classList.add('active');
    }
    
    if (screenId === 'main-screen') {
        updateBalanceDisplay();
    } else if (screenId === 'deposit-rub-screen') {
        generatePaymentId();
    } else if (screenId === 'withdraw-ton-screen') {
        document.getElementById('withdraw-available-ton').textContent = currentUser.balance_ton.toFixed(2);
    } else if (screenId === 'withdraw-rub-screen') {
        document.getElementById('withdraw-available-rub').textContent = currentUser.balance_rub;
    } else if (screenId === 'history-screen') {
        loadHistory();
    }
}

function selectCurrency(currency) {
    gameState.currency = currency;
    document.querySelectorAll('.currency-tab').forEach(t => t.classList.remove('active'));
    document.getElementById('tab-' + currency).classList.add('active');
    
    const isTon = currency === 'ton';
    const minBet = isTon ? 0.5 : 50;
    const maxBet = isTon ? 10 : 1000;
    const step = isTon ? 0.5 : 50;
    
    const slider = document.getElementById('bet-slider');
    slider.min = minBet;
    slider.max = maxBet;
    slider.step = step;
    slider.value = minBet;
    
    updateBet(minBet);
    
    const presets = document.querySelector('.bet-presets');
    presets.innerHTML = '';
    const values = isTon ? [0.5, 1, 2, 5, 10] : [50, 100, 250, 500, 1000];
    values.forEach(v => {
        const btn = document.createElement('button');
        btn.textContent = v;
        btn.onclick = function() { setBet(v); };
        presets.appendChild(btn);
    });
}

function updateBet(value) {
    gameState.bet = parseFloat(value);
    const isTon = gameState.currency === 'ton';
    const symbol = isTon ? ' TON' : ' ‚ÇΩ';
    document.getElementById('bet-display').textContent = value + symbol;
    
    const target = Math.floor(30 + (gameState.bet * (isTon ? 20 : 0.4)));
    gameState.targetScore = target;
    document.getElementById('target-score').textContent = target + ' –æ—á–∫–æ–≤';
    
    const prize = gameState.bet * 2;
    document.getElementById('prize-amount').textContent = prize + symbol;
}

function setBet(value) {
    document.getElementById('bet-slider').value = value;
    updateBet(value);
}

function generateTree() {
    const tree = document.getElementById('tree');
    const existing = tree.querySelectorAll('.trunk-section');
    existing.forEach(e => e.remove());
    
    gameState.treeSections = [];
    
    for (let i = 0; i < 6; i++) {
        const section = document.createElement('div');
        section.className = 'trunk-section';
        
        const hasBranch = Math.random() > 0.3 && i > 0;
        if (hasBranch) {
            const side = Math.random() > 0.5 ? 'left' : 'right';
            const branch = document.createElement('div');
            branch.className = 'branch ' + side;
            section.appendChild(branch);
            gameState.treeSections.push(side);
        } else {
            gameState.treeSections.push(null);
        }
        
        tree.appendChild(section);
    }
}

function createWoodChips(side) {
    const tree = document.getElementById('tree');
    
    for (let i = 0; i < 6; i++) {
        const chip = document.createElement('div');
        chip.className = 'wood-chip';
        chip.style.left = '60px';
        chip.style.top = '200px';
        
        const angle = (Math.random() - 0.5) * 60 + (side === 'left' ? -30 : 30);
        const distance = 50 + Math.random() * 100;
        const tx = Math.sin(angle * Math.PI / 180) * distance;
        const ty = -Math.cos(angle * Math.PI / 180) * distance - 50;
        const rot = Math.random() * 720;
        
        chip.style.setProperty('--tx', tx + 'px');
        chip.style.setProperty('--ty', ty + 'px');
        chip.style.setProperty('--rot', rot + 'deg');
        
        tree.appendChild(chip);
        setTimeout(() => chip.remove(), 500);
    }
}

function chop(side) {
    if (!gameState.isPlaying) return;
    
    const bottomSection = gameState.treeSections[0];
    if (bottomSection === side) {
        endGame(false);
        return;
    }
    
    gameState.score++;
    gameState.combo++;
    
    document.getElementById('current-score').textContent = gameState.score;
    
    const comboEl = document.getElementById('combo-display');
    if (gameState.combo > 5) {
        comboEl.textContent = 'x' + Math.floor(gameState.combo / 5);
        comboEl.classList.add('show');
        setTimeout(() => comboEl.classList.remove('show'), 1000);
    }
    
    gameState.timeLeft = Math.min(gameState.timeLeft + 1, gameState.maxTime);
    
    const lumberjack = document.getElementById('lumberjack');
    lumberjack.className = 'lumberjack ' + side;
    lumberjack.classList.add('chopping');
    setTimeout(() => lumberjack.classList.remove('chopping'), 150);
    
    createWoodChips(side);
    
    const sections = tree.querySelectorAll('.trunk-section');
    if (sections.length > 0) {
        sections[0].remove();
        gameState.treeSections.shift();
    }
    
    const newSection = document.createElement('div');
    newSection.className = 'trunk-section';
    const hasBranch = Math.random() > 0.3;
    if (hasBranch) {
        const branchSide = Math.random() > 0.5 ? 'left' : 'right';
        const branch = document.createElement('div');
        branch.className = 'branch ' + branchSide;
        newSection.appendChild(branch);
        gameState.treeSections.push(branchSide);
    } else {
        gameState.treeSections.push(null);
    }
    tree.appendChild(newSection);
    
    if (gameState.score >= gameState.targetScore) {
        endGame(true);
    }
}

function startGame() {
    const balanceField = gameState.currency === 'ton' ? 'balance_ton' : 'balance_rub';
    
    if (currentUser[balanceField] < gameState.bet) {
        showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
        return;
    }
    
    currentUser[balanceField] -= gameState.bet;
    updateBalanceDisplay();
    
    gameState.score = 0;
    gameState.isPlaying = true;
    gameState.timeLeft = gameState.maxTime;
    gameState.combo = 0;
    
    document.getElementById('current-score').textContent = '0';
    document.getElementById('game-target').textContent = gameState.targetScore;
    document.getElementById('combo-display').classList.remove('show');
    
    showScreen('play-screen');
    generateTree();
    
    gameState.timer = setInterval(function() {
        gameState.timeLeft -= 0.1;
        const pct = (gameState.timeLeft / gameState.maxTime) * 100;
        document.getElementById('time-fill').style.width = pct + '%';
        
        if (gameState.timeLeft <= 0) {
            endGame(false);
        }
    }, 100);
}

function endGame(win) {
    gameState.isPlaying = false;
    clearInterval(gameState.timer);
    
    const balanceField = gameState.currency === 'ton' ? 'balance_ton' : 'balance_rub';
    const symbol = gameState.currency === 'ton' ? ' TON' : ' ‚ÇΩ';
    
    let prize = 0;
    if (win) {
        prize = gameState.bet * 2;
        currentUser[balanceField] += prize;
    }
    
    updateBalanceDisplay();
    
    const resultContent = document.getElementById('result-content');
    const icon = document.getElementById('result-icon');
    const title = document.getElementById('result-title');
    const message = document.getElementById('result-message');
    
    if (win) {
        resultContent.className = 'result-content win';
        icon.textContent = 'üèÜ';
        title.textContent = '–ü–æ–±–µ–¥–∞!';
        document.getElementById('result-win').textContent = '+' + prize + symbol;
        message.textContent = '–û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!';
    } else {
        resultContent.className = 'result-content lose';
        icon.textContent = 'üíÄ';
        title.textContent = '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!';
        document.getElementById('result-win').textContent = '-' + gameState.bet + symbol;
        message.textContent = '–ù–µ —Å–¥–∞–≤–∞–π—Å—è! –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑!';
    }
    
    document.getElementById('result-score').textContent = gameState.score;
    
    showScreen('result-screen');
}

function updateBalanceDisplay() {
    document.getElementById('balance-ton').textContent = currentUser.balance_ton.toFixed(2);
    document.getElementById('balance-rub').textContent = currentUser.balance_rub;
}

function generatePaymentId() {
    const id = 'SBP_' + currentUser.id + '_' + Date.now();
    const codeEl = document.getElementById('payment-id-code');
    if (codeEl) {
        codeEl.textContent = id;
    }
    return id;
}

function submitDeposit(type) {
    if (type === 'ton') {
        const amount = parseFloat(document.getElementById('deposit-ton-amount').value);
        const from = document.getElementById('deposit-ton-from').value;
        
        if (!amount || amount < 1) {
            showNotification('–ú–∏–Ω–∏–º—É–º 1 TON');
            return;
        }
        if (!from) {
            showNotification('–£–∫–∞–∂–∏—Ç–µ –≤–∞—à –∞–¥—Ä–µ—Å');
            return;
        }
        
        showNotification('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞! –û–∂–∏–¥–∞–π—Ç–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è');
        showScreen('main-screen');
        
    } else {
        const amount = parseFloat(document.getElementById('deposit-rub-amount').value);
        
        if (!amount || amount < 100) {
            showNotification('–ú–∏–Ω–∏–º—É–º 100 ‚ÇΩ');
            return;
        }
        
        showNotification('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞! –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –Ω–∞–∂–º–∏—Ç–µ "–Ø –æ–ø–ª–∞—Ç–∏–ª"');
    }
}

function submitWithdraw(type) {
    if (type === 'ton') {
        const address = document.getElementById('withdraw-ton-address').value;
        const amount = parseFloat(document.getElementById('withdraw-ton-amount').value);
        
        if (!address) {
            showNotification('–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å');
            return;
        }
        if (!amount || amount < 5) {
            showNotification('–ú–∏–Ω–∏–º—É–º 5 TON');
            return;
        }
        if (amount > currentUser.balance_ton) {
            showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
            return;
        }
        
        showNotification('–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞!');
        showScreen('main-screen');
        
    } else {
        const phone = document.getElementById('withdraw-rub-phone').value;
        const amount = parseFloat(document.getElementById('withdraw-rub-amount').value);
        
        if (!phone) {
            showNotification('–£–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
            return;
        }
        if (!amount || amount < 500) {
            showNotification('–ú–∏–Ω–∏–º—É–º 500 ‚ÇΩ');
            return;
        }
        if (amount > currentUser.balance_rub) {
            showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
            return;
        }
        
        showNotification('–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞!');
        showScreen('main-screen');
    }
}

function showHistoryTab(tab) {
    currentHistoryTab = tab;
    document.querySelectorAll('.history-tabs .tab-btn').forEach(t => t.classList.remove('active'));
    document.getElementById('tab-' + tab).classList.add('active');
    loadHistory();
}

function loadHistory() {
    const list = document.getElementById('history-list');
    list.innerHTML = '<div class="empty-state">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>';
}

function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(function() {
            showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!');
        });
    } else {
        const input = document.createElement('input');
        input.value = text;
        document.body.appendChild(input);
        input.select();
        document.execCommand('copy');
        document.body.removeChild(input);
        showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!');
    }
}

function showNotification(text) {
    const notif = document.getElementById('notification');
    document.getElementById('notification-text').textContent = text;
    notif.classList.remove('hidden');
    setTimeout(function() {
        notif.classList.add('hidden');
    }, 3000);
}

document.addEventListener('keydown', function(e) {
    if (!gameState.isPlaying) return;
    if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') chop('left');
    if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') chop('right');
});

let lastTouchEnd = 0;
document.addEventListener('touchend', function(e) {
    const now = Date.now();
    if (now - lastTouchEnd <= 300) {
        e.preventDefault();
    }
    lastTouchEnd = now;
}, false);

updateBalanceDisplay();
    </script>
</body>
</html>
