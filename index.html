<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TimberTON</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #0f0f1e;
    color: white;
    min-height: 100vh;
    overflow-x: hidden;
}

.hidden { display: none !important; }

.screen {
    display: none;
    min-height: 100vh;
    padding: 80px 16px 20px;
}

.screen.active { display: block; }

.header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.98);
    padding: 12px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 1000;
    border-bottom: 1px solid #2a2a4a;
}

.balance-display {
    display: flex;
    gap: 16px;
}

.balance-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 14px;
    font-weight: 600;
}

.menu-btn {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: white;
    width: 40px;
    height: 40px;
    border-radius: 12px;
    font-size: 18px;
}

.logo-section {
    text-align: center;
    padding: 40px 20px;
}

.logo-icon {
    font-size: 80px;
    margin-bottom: 10px;
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.logo-section h1 {
    font-size: 32px;
    font-weight: 800;
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.subtitle {
    color: #a0a0b0;
    font-size: 14px;
    margin-top: 8px;
}

.game-preview {
    position: relative;
    height: 180px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 20px 0;
}

.preview-tree {
    font-size: 100px;
    position: absolute;
    animation: sway 4s ease-in-out infinite;
}

@keyframes sway {
    0%, 100% { transform: rotate(-2deg); }
    50% { transform: rotate(2deg); }
}

.preview-lumberjack {
    font-size: 50px;
    position: absolute;
    bottom: 20px;
    right: 25%;
    animation: chop 1s ease-in-out infinite;
}

@keyframes chop {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(-20deg); }
}

.main-actions {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.btn {
    border: none;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    padding: 18px 32px;
    width: 100%;
}

.btn-primary {
    background: linear-gradient(135deg, #ffd700 0%, #e6c200 100%);
    color: #000;
    font-size: 18px;
}

.btn-secondary {
    background: #1a1a2e;
    color: white;
    border: 1px solid #2a2a4a;
}

.btn-info {
    background: transparent;
    color: #a0a0b0;
    border: 1px solid #2a2a4a;
}

.btn-row {
    display: flex;
    gap: 12px;
}

.btn-row .btn {
    flex: 1;
}

.screen-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.98);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 1000;
    border-bottom: 1px solid #2a2a4a;
    padding-top: 60px;
}

.back-btn {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: white;
    width: 44px;
    height: 44px;
    border-radius: 12px;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.bet-container { padding: 20px; }

.section { margin-bottom: 24px; }

.section label {
    display: block;
    color: #a0a0b0;
    font-size: 14px;
    margin-bottom: 12px;
}

.currency-tabs {
    display: flex;
    gap: 8px;
    background: #1a1a2e;
    padding: 4px;
    border-radius: 12px;
}

.currency-tab {
    flex: 1;
    background: transparent;
    border: none;
    color: #a0a0b0;
    padding: 14px;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
}

.currency-tab.active {
    background: #ffd700;
    color: #000;
}

.bet-amount {
    font-size: 48px;
    font-weight: 800;
    text-align: center;
    color: #ffd700;
    margin: 20px 0;
}

.bet-slider {
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: #1a1a2e;
    outline: none;
    -webkit-appearance: none;
    margin: 20px 0;
}

.bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: #ffd700;
    cursor: pointer;
}

.bet-presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.bet-presets button {
    flex: 1;
    min-width: 60px;
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: white;
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
}

.prize-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 24px 0;
}

.prize-card {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

.prize-card.win { border-color: #00ff88; }

.prize-label {
    font-size: 12px;
    color: #a0a0b0;
    margin-bottom: 8px;
}

.prize-value {
    font-size: 24px;
    font-weight: 700;
    color: #ffd700;
}

.prize-card.win .prize-value { color: #00ff88; }

.rules-box {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 20px;
    margin: 24px 0;
}

.rules-box li {
    padding: 8px 0;
    padding-left: 24px;
    position: relative;
    color: #a0a0b0;
    font-size: 14px;
    list-style: none;
}

.rules-box li:before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: #00ff88;
}

.time-bar {
    position: fixed;
    top: 70px;
    left: 0;
    right: 0;
    height: 6px;
    background: #1a1a2e;
    z-index: 100;
}

.time-fill {
    height: 100%;
    background: linear-gradient(90deg, #00ff88 0%, #ffd700 50%, #ff4757 100%);
    width: 100%;
    transition: width 0.1s linear;
}

.score-board {
    text-align: center;
    padding: 40px 20px 20px;
}

.current-score {
    font-size: 72px;
    font-weight: 800;
    color: #ffd700;
    line-height: 1;
}

.target-display {
    margin-top: 10px;
    color: #a0a0b0;
    font-size: 16px;
}

.game-area {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 300px;
}

.tree-container {
    position: relative;
    width: 120px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 4px;
}

.trunk-section {
    width: 80px;
    height: 60px;
    background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
    border: 3px solid #5D3A1A;
    border-radius: 8px;
    position: relative;
}

.branch {
    position: absolute;
    width: 50px;
    height: 16px;
    background: linear-gradient(90deg, #228B22 0%, #32CD32 100%);
    border: 2px solid #006400;
    border-radius: 10px;
    top: 50%;
    transform: translateY(-50%);
}

.branch.left { left: -45px; }
.branch.right { right: -45px; }

.lumberjack {
    position: absolute;
    bottom: -90px;
    width: 70px;
    height: 80px;
    transition: all 0.15s;
    z-index: 10;
}

.lumberjack.left { left: -80px; }
.lumberjack.right { right: -80px; transform: scaleX(-1); }

.lumberjack-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #ff6b6b 0%, #c92a2a 100%);
    border-radius: 12px;
    position: relative;
}

.head {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
}

.axe {
    position: absolute;
    right: -25px;
    top: 20px;
    font-size: 30px;
}

.game-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, #0f0f1e6c200 100%);
    color: #000;
    font-size: 18px;
}

.btn-secondary {
    background: #1a1a2e;
    color: white;
    border: 1px solid #2a2a4a;
}

.btn-info {
    background: transparent;
    color: #a0a0b0;
    border: 1px solid #2a2a4a;
}

.btn-row {
    display: flex;
    gap: 12px;
}

.btn-row .btn {
    flex: 1;
}

.screen-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.98);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 1000;
    border-bottom: 1px solid #2a2a4a;
    padding-top: 60px;
}

.back-btn {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: white;
    width: 44px;
    height: 44px;
    border-radius: 12px;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.bet-container { padding: 20px; }

.section { margin-bottom: 24px; }

.section label {
    display: block;
    color: #a0a0b0;
    font-size: 14px;
    margin-bottom: 12px;
}

.currency-tabs {
    display: flex;
    gap: 8px;
    background: #1a1a2e;
    padding: 4px;
    border-radius: 12px;
}

.currency-tab {
    flex: 1;
    background: transparent;
    border: none;
    color: #a0a0b0;
    padding: 14px;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
}

.currency-tab.active {
    background: #ffd700;
    color: #000;
}

.bet-amount {
    font-size: 48px;
    font-weight: 800;
    text-align: center;
    color: #ffd700;
    margin: 20px 0;
}

.bet-slider {
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: #1a1a2e;
    outline: none;
    -webkit-appearance: none;
    margin: 20px 0;
}

.bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: #ffd700;
    cursor: pointer;
}

.bet-presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.bet-presets button {
    flex: 1;
    min-width: 60px;
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: white;
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
}

.prize-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 24px 0;
}

.prize-card {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

.prize-card.win { border-color: #00ff88; }

.prize-label {
    font-size: 12px;
    color: #a0a0b0;
    margin-bottom: 8px;
}

.prize-value {
    font-size: 24px;
    font-weight: 700;
    color: #ffd700;
}

.prize-card.win .prize-value { color: #00ff88; }

.rules-box {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 20px;
    margin: 24px 0;
}

.rules-box li {
    padding: 8px 0;
    padding-left: 24px;
    position: relative;
    color: #a0a0b0;
    font-size: 14px;
    list-style: none;
}

.rules-box li:before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: #00ff88;
}

.time-bar {
    position: fixed;
    top: 70px;
    left: 0;
    right: 0;
    height: 6px;
    background: #1a1a2e;
    z-index: 100;
}

.time-fill {
    height: 100%;
    background: linear-gradient(90deg, #00ff88 0%, #ffd700 50%, #ff4757 100%);
    width: 100%;
    transition: width 0.1s linear;
}

.score-board {
    text-align: center;
    padding: 40px 20px 20px;
}

.current-score {
    font-size: 72px;
    font-weight: 800;
    color: #ffd700;
    line-height: 1;
}

.target-display {
    margin-top: 10px;
    color: #a0a0b0;
    font-size: 16px;
}

.game-area {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 300px;
}

.tree-container {
    position: relative;
    width: 120px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 4px;
}

.trunk-section {
    width: 80px;
    height: 60px;
    background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
    border: 3px solid #5D3A1A;
    border-radius: 8px;
    position: relative;
}

.branch {
    position: absolute;
    width: 50px;
    height: 16px;
    background: linear-gradient(90deg, #228B22 0%, #32CD32 100%);
    border: 2px solid #006400;
    border-radius: 10px;
    top: 50%;
    transform: translateY(-50%);
}

.branch.left { left: -45px; }
.branch.right { right: -45px; }

.lumberjack {
    position: absolute;
    bottom: -90px;
    width: 70px;
    height: 80px;
    transition: all 0.15s;
    z-index: 10;
}

.lumberjack.left { left: -80px; }
.lumberjack.right { right: -80px; transform: scaleX(-1); }

.lumberjack-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #ff6b6b 0%, #c92a2a 100%);
    border-radius: 12px;
    position: relative;
}

.head {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
}

.axe {
    position: absolute;
    right: -25px;
    top: 20px;
    font-size: 30px;
}

.game-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, #0f0f1e 0%, transparent 100%);
    display: flex;
    gap: 16px;
    z-index: 100;
}

.chop-btn {
    flex: 1;
    height: 80px;
    border: none;
    border-radius: 20px;
    font-size: 36px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 8px 0 rgba(0,0,0,0.3);
}

.chop-btn.left {
    background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
    color: white;
}

.chop-btn.right {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
    color: white;
}

#result-screen {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.result-content {
    text-align: center;
    width: 100%;
    max-width: 400px;
}

.result-icon { font-size: 80px; margin-bottom: 20px; }

.result-content h2 {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 24px;
}

.result-content.win h2 { color: #00ff88; }
.result-content.lose h2 { color: #ff4757; }

.result-stats {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
}

.stat {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid #2a2a4a;
}

.stat:last-child { border-bottom: none; }

.stat-label { color: #a0a0b0; }
.stat-value { font-weight: 700; font-size: 18px; }

.result-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.deposit-options, .withdraw-options {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.option-card {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 20px;
    padding: 24px;
    text-align: center;
}

.option-icon { font-size: 48px; margin-bottom: 12px; }

.option-card h3 { font-size: 20px; margin-bottom: 8px; }
.option-card p { color: #a0a0b0; font-size: 14px; margin-bottom: 8px; }
.option-card small { color: #ffd700; font-size: 12px; font-weight: 600; }

.deposit-form, .withdraw-form { padding: 20px; }

.info-box, .bank-card, .payment-id-box {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
}

.copy-box {
    background: #0f0f1e;
    border: 2px dashed #2a2a4a;
    border-radius: 12px;
    padding: 16px;
    text-align: center;
}

.copy-box code {
    display: block;
    font-family: monospace;
    font-size: 13px;
    word-break: break-all;
    color: #ffd700;
    margin-bottom: 8px;
}

.copy-hint { font-size: 12px; color: #a0a0b0; }

.copy-box.important {
    border-color: #ff4757;
    background: rgba(255, 71, 87, 0.05);
}

.copy-box.important code {
    color: #ff4757;
    font-size: 16px;
    font-weight: 700;
}

.bank-card.sbp {
    background: linear-gradient(135deg, #0057b8 0%, #003d82 100%);
}

.bank-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.bank-logo { font-weight: 800; font-size: 20px; }

.sbp-badge {
    background: white;
    color: #0057b8;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
}

.bank-phone {
    font-size: 22px;
    font-weight: 700;
    text-align: center;
    padding: 12px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

.form-group { margin-bottom: 20px; }

.form-group label {
    display: block;
    font-size: 14px;
    color: #a0a0b0;
    margin-bottom: 8px;
}

.form-group input, .form-group select {
    width: 100%;
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 12px;
    padding: 16px;
    color: white;
    font-size: 16px;
}

.balance-info {
    background: #1a1a2e;
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 20px;
    text-align: center;
    color: #a0a0b0;
}

.balance-info strong { color: #ffd700; font-size: 20px; }

.hint {
    text-align: center;
    color: #a0a0b0;
    font-size: 13px;
    margin-top: 16px;
}

.history-tabs {
    display: flex;
    gap: 8px;
    padding: 0 20px;
    margin-bottom: 20px;
    overflow-x: auto;
}

.tab-btn {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: #a0a0b0;
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    white-space: nowrap;
}

.tab-btn.active {
    background: #ffd700;
    color: #000;
    border-color: #ffd700;
}

.history-list { padding: 0 20px; }

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: #a0a0b0;
}

.notification {
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    padding: 16px 24px;
    border-radius: 12px;
    z-index: 10000;
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
    to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

.wood-chip {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #DEB887;
    border-radius: 2px;
    pointer-events: none;
    animation: chipFly 0.5s ease-out forwards;
}

@keyframes chipFly {
    0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
    100% { transform: translate(var(--tx), var(--ty)) rotate(var(--rot)); opacity: 0; }
}
    </style>
</head>
<body>
    <div class="header">
        <div class="balance-display">
            <div class="balance-item">
                <span>üíé</span>
                <span id="balance-ton">0.00</span> TON
            </div>
            <div class="balance-item">
                <span>‚ÇΩ</span>
                <span id="balance-rub">0</span>
            </div>
        </div>
        <button class="menu-btn" onclick="goHome()">üè†</button>
    </div>

    <div id="main-screen" class="screen active">
        <div class="logo-section">
            <div class="logo-icon">ü™ì</div>
            <h1>TimberTON</h1>
            <p class="subtitle">–†—É–±–∏ –¥–µ—Ä–µ–≤—å—è ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π TON –∏ —Ä—É–±–ª–∏!</p>
        </div>

        <div class="game-preview">
            <div class="preview-tree">üå≤</div>
            <div class="preview-lumberjack">ü™ì</div>
        </div>

        <div class="main-actions">
            <button class="btn btn-primary" onclick="openGameMenu()">üéÆ –ò–ì–†–ê–¢–¨</button>
            <div class="btn-row">
                <button class="btn btn-secondary" onclick="openDeposit()">üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
                <button class="btn btn-secondary" onclick="openWithdraw()">üí∏ –í—ã–≤–µ—Å—Ç–∏</button>
            </div>
            <button class="btn btn-info" onclick="openHistory()">üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</button>
        </div>
    </div>

    <div id="game-menu-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
        </div>

        <div class="bet-container">
            <div class="section">
                <label>–í–∞–ª—é—Ç–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="currency-tabs">
                    <button class="currency-tab active" id="btn-ton" onclick="setCurrency('ton')">üíé TON</button>
                    <button class="currency-tab" id="btn-rub" onclick="setCurrency('rub')">‚ÇΩ –†—É–±–ª–∏</button>
                </div>
            </div>

            <div class="section">
                <label>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="bet-amount" id="bet-display">0.5 TON</div>
                <input type="range" class="bet-slider" id="bet-slider" min="0.5" max="10" step="0.5" value="0.5" oninput="updateBet(this.value)">
                <div class="bet-presets" id="bet-presets">
                    <button onclick="setBetValue(0.5)">0.5</button>
                    <button onclick="setBetValue(1)">1</button>
                    <button onclick="setBetValue(2)">2</button>
                    <button onclick="setBetValue(5)">5</button>
                    <button onclick="setBetValue(10)">10</button>
                </div>
            </div>

            <div class="prize-info">
                <div class="prize-card">
                    <div class="prize-label">üéØ –¶–µ–ª—å</div>
                    <div class="prize-value" id="target-score">50</div>
                    <small>–æ—á–∫–æ–≤ –∑–∞ 30 —Å–µ–∫</small>
                </div>
                <div class="prize-card win">
                    <div class="prize-label">üèÜ –í—ã–∏–≥—Ä—ã—à</div>
                    <div class="prize-value" id="prize-amount">1.0 TON</div>
                    <small>x2 –æ—Ç —Å—Ç–∞–≤–∫–∏</small>
                </div>
            </div>

            <div class="rules-box">
                <h4>üìã –ü—Ä–∞–≤–∏–ª–∞:</h4>
                <ul>
                    <li>–†—É–±–∏ –¥–µ—Ä–µ–≤–æ –∫–Ω–æ–ø–∫–∞–º–∏ ‚Üê ‚Üí</li>
                    <li>–ò–∑–±–µ–≥–∞–π –≤–µ—Ç–æ–∫ ‚Äî –∏–Ω–∞—á–µ –ø—Ä–æ–∏–≥—Ä—ã—à!</li>
                    <li>–ö–∞–∂–¥—ã–π —É–¥–∞—Ä = +1 –æ—á–∫–æ</li>
                    <li>–ù–∞–±–µ—Ä–∏ —Ü–µ–ª—å –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è</li>
                </ul>
            </div>

            <button class="btn btn-primary" onclick="startGame()">‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨ –ò–ì–†–£</button>
        </div>
    </div>

    <div id="play-screen" class="screen">
        <div class="time-bar">
            <div class="time-fill" id="time-fill"></div>
        </div>

        <div class="score-board">
            <div class="current-score" id="current-score">0</div>
            <div class="target-display">–¶–µ–ª—å: <span id="game-target">50</span></div>
        </div>

        <div class="game-area">
            <div class="tree-container" id="tree">
                <div class="lumberjack left" id="lumberjack">
                    <div class="lumberjack-body">
                        <div class="head">üë∑</div>
                        <div class="axe">ü™ì</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-controls">
            <button class="chop-btn left" ontouchstart="doChop('left'); return false;" onmousedown="doChop('left')">‚Üê</button>
            <button class="chop-btn right" ontouchstart="doChop('right'); return false;" onmousedown="doChop('right')">‚Üí</button>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <div class="result-content" id="result-box">
            <div class="result-icon" id="result-icon">üèÜ</div>
            <h2 id="result-title">–ü–æ–±–µ–¥–∞!</h2>
            
            <div class="result-stats">
                <div class="stat">
                    <span class="stat-label">–û—á–∫–∏:</span>
                    <span class="stat-value" id="result-score">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                    <span class="stat-value" id="result-amount">+1.0 TON</span>
                </div>
            </div>

            <div class="result-message" id="result-message">–û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞!</div>

            <div class="result-actions">
                <button class="btn btn-primary" onclick="openGameMenu()">üîÑ –ò–≥—Ä–∞—Ç—å –µ—â—ë</button>
                <button class="btn btn-secondary" onclick="goHome()">üè† –í –º–µ–Ω—é</button>
            </div>
        </div>
    </div>

    <div id="deposit-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h2>
        </div>

        <div class="deposit-options">
            <div class="option-card" onclick="showScreen('deposit-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h3>
                <p>–û—Ç–ø—Ä–∞–≤—å TON –Ω–∞ –∞–¥—Ä–µ—Å –ø—Ä–æ–µ–∫—Ç–∞</p>
                <small>–ú–∏–Ω–∏–º—É–º: 1 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('deposit-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h3>
                <p>–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –°–ë–ü –Ω–∞ OZON –ë–∞–Ω–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 100 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="deposit-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h2>
        </div>

        <div class="deposit-form">
            <div class="info-box">
                <h4>–ê–¥—Ä–µ—Å –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:</h4>
                <div class="copy-box" onclick="copyText('UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh')">
                    <code>UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh</code>
                    <span class="copy-hint">üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ TON –æ—Ç–ø—Ä–∞–≤–∏–ª–∏:</label>
                <input type="number" id="dep-ton-amount" step="0.1" min="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5">
            </div>

            <div class="form-group">
                <label>–í–∞—à TON-–∞–¥—Ä–µ—Å:</label>
                <input type="text" id="dep-ton-addr" placeholder="UQ...">
            </div>

            <button class="btn btn-primary" onclick="submitDepositTon()">‚úÖ –Ø –æ—Ç–ø—Ä–∞–≤–∏–ª TON</button>
            <p class="hint">–ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏</p>
        </div>
    </div>

    <div id="deposit-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>‚ÇΩ –ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h2>
        </div>

        <div class="deposit-form">
            <div class="bank-card sbp">
                <div class="bank-header">
                    <span class="bank-logo">OZON</span>
                    <span class="sbp-badge">–°–ë–ü</span>
                </div>
                <div class="bank-phone" onclick="copyText('+79941402339')">
                    +7 (994) 140-23-39
                    <small>üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</small>
                </div>
            </div>

            <div class="payment-id-box">
                <h4>–í–∞—à ID –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:</h4>
                <div class="copy-box important">
                    <code id="pay-id">–ó–∞–≥—Ä—É–∑–∫–∞...</code>
                    <span class="copy-hint">‚ö†Ô∏è –£–∫–∞–∂–∏ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–µ—Ä–µ–≤–æ–¥—É!</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ (‚ÇΩ):</label>
                <input type="number" id="dep-rub-amount" min="100" step="100" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 500">
            </div>

            <button class="btn btn-primary" onclick="submitDepositRub()">‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–ª</button>
            <p class="hint">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 5-15 –º–∏–Ω—É—Ç</p>
        </div>
    </div>

    <div id="withdraw-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h2>
        </div>

        <div class="withdraw-options">
            <div class="option-card" onclick="showScreen('withdraw-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ TON</h3>
                <p>–ù–∞ –≤–∞—à TON-–∫–æ—à–µ–ª—ë–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 5 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('withdraw-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ —Ä—É–±–ª–∏</h3>
                <p>–ù–∞ –∫–∞—Ä—Ç—É —á–µ—Ä–µ–∑ –°–ë–ü</p>
                <small>–ú–∏–Ω–∏–º—É–º: 500 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="withdraw-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>üíé –í—ã–≤–æ–¥ TON</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="wd-ton-bal">0.00</strong> TON
            </div>

            <div class="form-group">
               e6c200 100%);
    color: #000;
    font-size: 18px;
}

.btn-secondary {
    background: #1a1a2e;
    color: white;
    border: 1px solid #2a2a4a;
}

.btn-info {
    background: transparent;
    color: #a0a0b0;
    border: 1px solid #2a2a4a;
}

.btn-row {
    display: flex;
    gap: 12px;
}

.btn-row .btn {
    flex: 1;
}

.screen-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.98);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 1000;
    border-bottom: 1px solid #2a2a4a;
    padding-top: 60px;
}

.back-btn {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: white;
    width: 44px;
    height: 44px;
    border-radius: 12px;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.bet-container { padding: 20px; }

.section { margin-bottom: 24px; }

.section label {
    display: block;
    color: #a0a0b0;
    font-size: 14px;
    margin-bottom: 12px;
}

.currency-tabs {
    display: flex;
    gap: 8px;
    background: #1a1a2e;
    padding: 4px;
    border-radius: 12px;
}

.currency-tab {
    flex: 1;
    background: transparent;
    border: none;
    color: #a0a0b0;
    padding: 14px;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
}

.currency-tab.active {
    background: #ffd700;
    color: #000;
}

.bet-amount {
    font-size: 48px;
    font-weight: 800;
    text-align: center;
    color: #ffd700;
    margin: 20px 0;
}

.bet-slider {
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: #1a1a2e;
    outline: none;
    -webkit-appearance: none;
    margin: 20px 0;
}

.bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: #ffd700;
    cursor: pointer;
}

.bet-presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.bet-presets button {
    flex: 1;
    min-width: 60px;
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: white;
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
}

.prize-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 24px 0;
}

.prize-card {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

.prize-card.win { border-color: #00ff88; }

.prize-label {
    font-size: 12px;
    color: #a0a0b0;
    margin-bottom: 8px;
}

.prize-value {
    font-size: 24px;
    font-weight: 700;
    color: #ffd700;
}

.prize-card.win .prize-value { color: #00ff88; }

.rules-box {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 20px;
    margin: 24px 0;
}

.rules-box li {
    padding: 8px 0;
    padding-left: 24px;
    position: relative;
    color: #a0a0b0;
    font-size: 14px;
    list-style: none;
}

.rules-box li:before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: #00ff88;
}

.time-bar {
    position: fixed;
    top: 70px;
    left: 0;
    right: 0;
    height: 6px;
    background: #1a1a2e;
    z-index: 100;
}

.time-fill {
    height: 100%;
    background: linear-gradient(90deg, #00ff88 0%, #ffd700 50%, #ff4757 100%);
    width: 100%;
    transition: width 0.1s linear;
}

.score-board {
    text-align: center;
    padding: 40px 20px 20px;
}

.current-score {
    font-size: 72px;
    font-weight: 800;
    color: #ffd700;
    line-height: 1;
}

.target-display {
    margin-top: 10px;
    color: #a0a0b0;
    font-size: 16px;
}

.game-area {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 300px;
}

.tree-container {
    position: relative;
    width: 120px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 4px;
}

.trunk-section {
    width: 80px;
    height: 60px;
    background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
    border: 3px solid #5D3A1A;
    border-radius: 8px;
    position: relative;
}

.branch {
    position: absolute;
    width: 50px;
    height: 16px;
    background: linear-gradient(90deg, #228B22 0%, #32CD32 100%);
    border: 2px solid #006400;
    border-radius: 10px;
    top: 50%;
    transform: translateY(-50%);
}

.branch.left { left: -45px; }
.branch.right { right: -45px; }

.lumberjack {
    position: absolute;
    bottom: -90px;
    width: 70px;
    height: 80px;
    transition: all 0.15s;
    z-index: 10;
}

.lumberjack.left { left: -80px; }
.lumberjack.right { right: -80px; transform: scaleX(-1); }

.lumberjack-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #ff6b6b 0%, #c92a2a 100%);
    border-radius: 12px;
    position: relative;
}

.head {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
}

.axe {
    position: absolute;
    right: -25px;
    top: 20px;
    font-size: 30px;
}

.game-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, #0f0f1e 0%, transparent 100%);
    display: flex;
    gap: 16px;
    z-index: 100;
}

.chop-btn {
    flex: 1;
    height: 80px;
    border: none;
    border-radius: 20px;
    font-size: 36px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 8px 0 rgba(0,0,0,0.3);
}

.chop-btn.left {
    background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
    color: white;
}

.chop-btn.right {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
    color: white;
}

#result-screen {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.result-content {
    text-align: center;
    width: 100%;
    max-width: 400px;
}

.result-icon { font-size: 80px; margin-bottom: 20px; }

.result-content h2 {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 24px;
}

.result-content.win h2 { color: #00ff88; }
.result-content.lose h2 { color: #ff4757; }

.result-stats {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
}

.stat {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid #2a2a4a;
}

.stat:last-child { border-bottom: none; }

.stat-label { color: #a0a0b0; }
.stat-value { font-weight: 700; font-size: 18px; }

.result-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.deposit-options, .withdraw-options {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.option-card {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 20px;
    padding: 24px;
    text-align: center;
}

.option-icon { font-size: 48px; margin-bottom: 12px; }

.option-card h3 { font-size: 20px; margin-bottom: 8px; }
.option-card p { color: #a0a0b0; font-size: 14px; margin-bottom: 8px; }
.option-card small { color: #ffd700; font-size: 12px; font-weight: 600; }

.deposit-form, .withdraw-form { padding: 20px; }

.info-box, .bank-card, .payment-id-box {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
}

.copy-box {
    background: #0f0f1e;
    border: 2px dashed #2a2a4a;
    border-radius: 12px;
    padding: 16px;
    text-align: center;
}

.copy-box code {
    display: block;
    font-family: monospace;
    font-size: 13px;
    word-break: break-all;
    color: #ffd700;
    margin-bottom: 8px;
}

.copy-hint { font-size: 12px; color: #a0a0b0; }

.copy-box.important {
    border-color: #ff4757;
    background: rgba(255, 71, 87, 0.05);
}

.copy-box.important code {
    color: #ff4757;
    font-size: 16px;
    font-weight: 700;
}

.bank-card.sbp {
    background: linear-gradient(135deg, #0057b8 0%, #003d82 100%);
}

.bank-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.bank-logo { font-weight: 800; font-size: 20px; }

.sbp-badge {
    background: white;
    color: #0057b8;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
}

.bank-phone {
    font-size: 22px;
    font-weight: 700;
    text-align: center;
    padding: 12px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

.form-group { margin-bottom: 20px; }

.form-group label {
    display: block;
    font-size: 14px;
    color: #a0a0b0;
    margin-bottom: 8px;
}

.form-group input, .form-group select {
    width: 100%;
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 12px;
    padding: 16px;
    color: white;
    font-size: 16px;
}

.balance-info {
    background: #1a1a2e;
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 20px;
    text-align: center;
    color: #a0a0b0;
}

.balance-info strong { color: #ffd700; font-size: 20px; }

.hint {
    text-align: center;
    color: #a0a0b0;
    font-size: 13px;
    margin-top: 16px;
}

.history-tabs {
    display: flex;
    gap: 8px;
    padding: 0 20px;
    margin-bottom: 20px;
    overflow-x: auto;
}

.tab-btn {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: #a0a0b0;
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    white-space: nowrap;
}

.tab-btn.active {
    background: #ffd700;
    color: #000;
    border-color: #ffd700;
}

.history-list { padding: 0 20px; }

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: #a0a0b0;
}

.notification {
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    padding: 16px 24px;
    border-radius: 12px;
    z-index: 10000;
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
    to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

.wood-chip {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #DEB887;
    border-radius: 2px;
    pointer-events: none;
    animation: chipFly 0.5s ease-out forwards;
}

@keyframes chipFly {
    0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
    100% { transform: translate(var(--tx), var(--ty)) rotate(var(--rot)); opacity: 0; }
}
    </style>
</head>
<body>
    <div class="header">
        <div class="balance-display">
            <div class="balance-item">
                <span>üíé</span>
                <span id="balance-ton">0.00</span> TON
            </div>
            <div class="balance-item">
                <span>‚ÇΩ</span>
                <span id="balance-rub">0</span>
            </div>
        </div>
        <button class="menu-btn" onclick="goHome()">üè†</button>
    </div>

    <div id="main-screen" class="screen active">
        <div class="logo-section">
            <div class="logo-icon">ü™ì</div>
            <h1>TimberTON</h1>
            <p class="subtitle">–†—É–±–∏ –¥–µ—Ä–µ–≤—å—è ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π TON –∏ —Ä—É–±–ª–∏!</p>
        </div>

        <div class="game-preview">
            <div class="preview-tree">üå≤</div>
            <div class="preview-lumberjack">ü™ì</div>
        </div>

        <div class="main-actions">
            <button class="btn btn-primary" onclick="openGameMenu()">üéÆ –ò–ì–†–ê–¢–¨</button>
            <div class="btn-row">
                <button class="btn btn-secondary" onclick="openDeposit()">üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
                <button class="btn btn-secondary" onclick="openWithdraw()">üí∏ –í—ã–≤–µ—Å—Ç–∏</button>
            </div>
            <button class="btn btn-info" onclick="openHistory()">üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</button>
        </div>
    </div>

    <div id="game-menu-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
        </div>

        <div class="bet-container">
            <div class="section">
                <label>–í–∞–ª—é—Ç–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="currency-tabs">
                    <button class="currency-tab active" id="btn-ton" onclick="setCurrency('ton')">üíé TON</button>
                    <button class="currency-tab" id="btn-rub" onclick="setCurrency('rub')">‚ÇΩ –†—É–±–ª–∏</button>
                </div>
            </div>

            <div class="section">
                <label>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="bet-amount" id="bet-display">0.5 TON</div>
                <input type="range" class="bet-slider" id="bet-slider" min="0.5" max="10" step="0.5" value="0.5" oninput="updateBet(this.value)">
                <div class="bet-presets" id="bet-presets">
                    <button onclick="setBetValue(0.5)">0.5</button>
                    <button onclick="setBetValue(1)">1</button>
                    <button onclick="setBetValue(2)">2</button>
                    <button onclick="setBetValue(5)">5</button>
                    <button onclick="setBetValue(10)">10</button>
                </div>
            </div>

            <div class="prize-info">
                <div class="prize-card">
                    <div class="prize-label">üéØ –¶–µ–ª—å</div>
                    <div class="prize-value" id="target-score">50</div>
                    <small>–æ—á–∫–æ–≤ –∑–∞ 30 —Å–µ–∫</small>
                </div>
                <div class="prize-card win">
                    <div class="prize-label">üèÜ –í—ã–∏–≥—Ä—ã—à</div>
                    <div class="prize-value" id="prize-amount">1.0 TON</div>
                    <small>x2 –æ—Ç —Å—Ç–∞–≤–∫–∏</small>
                </div>
            </div>

            <div class="rules-box">
                <h4>üìã –ü—Ä–∞–≤–∏–ª–∞:</h4>
                <ul>
                    <li>–†—É–±–∏ –¥–µ—Ä–µ–≤–æ –∫–Ω–æ–ø–∫–∞–º–∏ ‚Üê ‚Üí</li>
                    <li>–ò–∑–±–µ–≥–∞–π –≤–µ—Ç–æ–∫ ‚Äî –∏–Ω–∞—á–µ –ø—Ä–æ–∏–≥—Ä—ã—à!</li>
                    <li>–ö–∞–∂–¥—ã–π —É–¥–∞—Ä = +1 –æ—á–∫–æ</li>
                    <li>–ù–∞–±–µ—Ä–∏ —Ü–µ–ª—å –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è</li>
                </ul>
            </div>

            <button class="btn btn-primary" onclick="startGame()">‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨ –ò–ì–†–£</button>
        </div>
    </div>

    <div id="play-screen" class="screen">
        <div class="time-bar">
            <div class="time-fill" id="time-fill"></div>
        </div>

        <div class="score-board">
            <div class="current-score" id="current-score">0</div>
            <div class="target-display">–¶–µ–ª—å: <span id="game-target">50</span></div>
        </div>

        <div class="game-area">
            <div class="tree-container" id="tree">
                <div class="lumberjack left" id="lumberjack">
                    <div class="lumberjack-body">
                        <div class="head">üë∑</div>
                        <div class="axe">ü™ì</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-controls">
            <button class="chop-btn left" ontouchstart="doChop('left'); return false;" onmousedown="doChop('left')">‚Üê</button>
            <button class="chop-btn right" ontouchstart="doChop('right'); return false;" onmousedown="doChop('right')">‚Üí</button>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <div class="result-content" id="result-box">
            <div class="result-icon" id="result-icon">üèÜ</div>
            <h2 id="result-title">–ü–æ–±–µ–¥–∞!</h2>
            
            <div class="result-stats">
                <div class="stat">
                    <span class="stat-label">–û—á–∫–∏:</span>
                    <span class="stat-value" id="result-score">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                    <span class="stat-value" id="result-amount">+1.0 TON</span>
                </div>
            </div>

            <div class="result-message" id="result-message">–û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞!</div>

            <div class="result-actions">
                <button class="btn btn-primary" onclick="openGameMenu()">üîÑ –ò–≥—Ä–∞—Ç—å –µ—â—ë</button>
                <button class="btn btn-secondary" onclick="goHome()">üè† –í –º–µ–Ω—é</button>
            </div>
        </div>
    </div>

    <div id="deposit-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h2>
        </div>

        <div class="deposit-options">
            <div class="option-card" onclick="showScreen('deposit-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h3>
                <p>–û—Ç–ø—Ä–∞–≤—å TON –Ω–∞ –∞–¥—Ä–µ—Å –ø—Ä–æ–µ–∫—Ç–∞</p>
                <small>–ú–∏–Ω–∏–º—É–º: 1 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('deposit-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h3>
                <p>–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –°–ë–ü –Ω–∞ OZON –ë–∞–Ω–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 100 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="deposit-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h2>
        </div>

        <div class="deposit-form">
            <div class="info-box">
                <h4>–ê–¥—Ä–µ—Å –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:</h4>
                <div class="copy-box" onclick="copyText('UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh')">
                    <code>UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh</code>
                    <span class="copy-hint">üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ TON –æ—Ç–ø—Ä–∞–≤–∏–ª–∏:</label>
                <input type="number" id="dep-ton-amount" step="0.1" min="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5">
            </div>

            <div class="form-group">
                <label>–í–∞—à TON-–∞–¥—Ä–µ—Å:</label>
                <input type="text" id="dep-ton-addr" placeholder="UQ...">
            </div>

            <button class="btn btn-primary" onclick="submitDepositTon()">‚úÖ –Ø –æ—Ç–ø—Ä–∞–≤–∏–ª TON</button>
            <p class="hint">–ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏</p>
        </div>
    </div>

    <div id="deposit-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>‚ÇΩ –ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h2>
        </div>

        <div class="deposit-form">
            <div class="bank-card sbp">
                <div class="bank-header">
                    <span class="bank-logo">OZON</span>
                    <span class="sbp-badge">–°–ë–ü</span>
                </div>
                <div class="bank-phone" onclick="copyText('+79941402339')">
                    +7 (994) 140-23-39
                    <small>üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</small>
                </div>
            </div>

            <div class="payment-id-box">
                <h4>–í–∞—à ID –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:</h4>
                <div class="copy-box important">
                    <code id="pay-id">–ó–∞–≥—Ä—É–∑–∫–∞...</code>
                    <span class="copy-hint">‚ö†Ô∏è –£–∫–∞–∂–∏ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–µ—Ä–µ–≤–æ–¥—É!</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ (‚ÇΩ):</label>
                <input type="number" id="dep-rub-amount" min="100" step="100" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 500">
            </div>

            <button class="btn btn-primary" onclick="submitDepositRub()">‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–ª</button>
            <p class="hint">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 5-15 –º–∏–Ω—É—Ç</p>
        </div>
    </div>

    <div id="withdraw-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h2>
        </div>

        <div class="withdraw-options">
            <div class="option-card" onclick="showScreen('withdraw-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ TON</h3>
                <p>–ù–∞ –≤–∞—à TON-–∫–æ—à–µ–ª—ë–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 5 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('withdraw-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ —Ä—É–±–ª–∏</h3>
                <p>–ù–∞ –∫–∞—Ä—Ç—É —á–µ—Ä–µ–∑ –°–ë–ü</p>
                <small>–ú–∏–Ω–∏–º—É–º: 500 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="withdraw-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>üíé –í—ã–≤–æ–¥ TON</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="wd-ton-bal">0.00</strong> TON
            </div>

            <div class="form-group">
                <label>TON-–∞–¥—Ä–µ—Å:</label>
                <input type="text" id="wd-ton-addr" placeholder="UQ...">
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞:</label>
                <input type="number" id="wd-ton-amount" step="0.1" min="5" placeholder="–ú–∏–Ω–∏–º—É–º 5 TON">
            </div>

            <button class="btn btn-primary" onclick="submitWithdrawTon()">üöÄ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥</button>
            <p class="hint">–û–±—Ä–∞–±–æ—Ç–∫–∞: –¥–æ 24 —á–∞—Å–æ–≤</p>
        </div>
    </div>

    <div id="withdraw-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>‚ÇΩ –í—ã–≤–æ–¥ —Ä—É–±–ª–µ–π</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="wd-rub-bal">0</strong> ‚ÇΩ
            </div>

            <div class="form-group">
                <label>–¢–µ–ª–µ—Ñ–æ–Ω (–°–ë–ü):</label>
                <input type="tel" id="wd-rub-phone" placeholder="+7 (999) 123-45-67">
            </div>

            <div class="form-group">
                <label>–ë–∞–Ω–∫:</label>
                <select id="wd-rub-bank">
                    <option value="–°–±–µ—Ä–±–∞–Ω–∫">üè¶ –°–±–µ—Ä–±–∞–Ω–∫</option>
                    <option value="–¢–∏–Ω—å–∫–æ—Ñ—Ñ">üü° –¢–∏–Ω—å–∫–æ—Ñ—Ñ</option>
                    <option value="–í–¢–ë">üîµ –í–¢–ë</option>
                    <option value="–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫">üü£ –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫</option>
                    <option value="–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω">üü¢ –†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω</option>
                    <option value="–î—Ä—É–≥–æ–π">‚ö™ –î—Ä—É–≥–æ–π</option>
                </select>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ (‚ÇΩ):</label>
                <input type="number" id="wd-rub-amount" min="500" step="100" placeholder="–ú–∏–Ω–∏–º—É–º 500 ‚ÇΩ">
            </div>

            <button class="btn btn-primary" onclick="submitWithdrawRub()">üöÄ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥</button>
            <p class="hint">–û–±—Ä–∞–±–æ—Ç–∫–∞: –¥–æ 24 —á–∞—Å–æ–≤</p>
        </div>
    </div>

    <div id="history-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üìä –ò—Å—Ç–æ—Ä–∏—è</h2>
        </div>

        <div class="history-tabs">
            <button class="tab-btn active" id="hist-games" onclick="switchTab('games')">üéÆ –ò–≥—Ä—ã</button>
            <button class="tab-btn" id="hist-deps" onclick="switchTab('deposits')">üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è</button>
            <button class="tab-btn" id="hist-wds" onclick="switchTab('withdrawals')">üí∏ –í—ã–≤–æ–¥—ã</button>
        </div>

        <div class="history-list" id="history-content">
            <div class="empty-state">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>
        </div>
    </div>

    <div id="notification" class="notification hidden">
        <span id="notif-text"></span>
    </div>

    <script>
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let user = {
    id: 'demo',
    balanceTon: 10.00,
    balanceRub: 1000,
    username: 'player'
};

let game = {
    active: false,
    score: 0,
    target: 50,
    timeLeft: 30,
    timer: null,
    bet: 0.5,
    currency: 'ton',
    position: 'left',
    tree: []
};

let historyData = {
    games: [],
    deposits: [],
    withdrawals: []
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
let tg = null;
try {
    tg = window.Telegram.WebApp;
    tg.expand();
    tg.ready();
    if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
        user.id = tg.initDataUnsafe.user.id.toString();
        user.username = tg.initDataUnsafe.user.username || 'player';
    }
} catch(e) {
    console.log('Telegram WebApp not available');
}

// –ù–∞–≤–∏–≥–∞—Ü–∏—è
function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    
    if (id === 'deposit-rub-screen') {
        generatePayId();
    } else if (id === 'withdraw-ton-screen') {
        document.getElementById('wd-ton-bal').textContent = user.balanceTon.toFixed(2);
    } else if (id === 'withdraw-rub-screen') {
        document.getElementById('wd-rub-bal').textContent = user.balanceRub;
    } else if (id === 'history-screen') {
        renderHistory();
    }
}

function goHome() {
    showScreen('main-screen');
    updateBalance();
}

function openGameMenu() {
    showScreen('game-menu-screen');
    setCurrency('ton');
}

function openDeposit() {
    showScreen('deposit-screen');
}

function openWithdraw() {
    showScreen('withdraw-screen');
}

function openHistory() {
    showScreen('history-screen');
    switchTab('games');
}

// –ò–≥—Ä–∞ - –º–µ–Ω—é —Å—Ç–∞–≤–æ–∫
function setCurrency(curr) {
    game.currency = curr;
    document.getElementById('btn-ton').classList.toggle('active', curr === 'ton');
    document.getElementById('btn-rub').classList.toggle('active', curr === 'rub');
    
    const isTon = curr === 'ton';
    const slider = document.getElementById('bet-slider');
    const presets = document.getElementById('bet-presets');
    
    slider.min = isTon ? 0.5 : 50;
    slider.max = isTon ? 10 : 1000;
    slider.step = isTon ? 0.5 : 50;
    slider.value = isTon ? 0.5 : 50;
    
    presets.innerHTML = '';
    const vals = isTon ? [0.5, 1, 2, 5, 10] : [50, 100, 250, 500, 1000];
    vals.forEach(v => {
        const b = document.createElement('button');
        b.textContent = v;
        b.onclick = function() { setBetValue(v); };
        presets.appendChild(b);
    });
    
    updateBet(slider.value);
}

function updateBet(val) {
    game.bet = parseFloat(val);
    const sym = game.currency === 'ton' ? ' TON' : ' ‚ÇΩ';
    document.getElementById('bet-display').textContent = val + sym;
    
    const target = Math.floor(30 + (game.bet * (game.currency === 'ton' ? 20 : 0.4)));
    game.target = target;
    document.getElementById('target-score').textContent = target;
    
    const prize = game.bet * 2;
    document.getElementById('prize-amount').textContent = prize + sym;
}

function setBetValue(val) {
    document.getElementById('bet-slider').value = val;
    updateBet(val);
}

// –ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å
function startGame() {
    const bal = game.currency === 'ton' ? user.balanceTon : user.balanceRub;
    if (bal < game.bet) {
        notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
        return;
    }
    
    if (game.currency === 'ton') user.balanceTon -= game.bet;
    else user.balanceRub -= game.bet;
    updateBalance();
    
    game.active = true;
    game.score = 0;
    game.timeLeft = 30;
    game.tree = [];
    
    showScreen('play-screen');
    document.getElementById('current-score').textContent = '0';
    document.getElementById('game-target').textContent = game.target;
    document.getElementById('time-fill').style.width = '100%';
    
    generateTree();
    
    game.timer = setInterval(function() {
        game.timeLeft -= 0.1;
        const pct = (game.timeLeft / 30) * 100;
        document.getElementById('time-fill').style.width = pct + '%';
        
        if (game.timeLeft <= 0) {
            endGame(false);
        }
    }, 100);
}

function generateTree() {
    const container = document.getElementById('tree');
    const sections = container.querySelectorAll('.trunk-section');
    sections.forEach(s => s.remove());
    
    game.tree = [];
    
    for (let i = 0; i < 6; i++) {
        const div = document.createElement('div');
        div.className = 'trunk-section';
        
        const hasBranch = Math.random() > 0.3 && i > 0;
        if (hasBranch) {
            const side = Math.random() > 0.5 ? 'left' : 'right';
            const b = document.createElement('div');
            b.className = 'branch ' + side;
            div.appendChild(b);
            game.tree.push(side);
        } else {
            game.tree.push(null);
        }
        
        container.appendChild(div);
    }
}

function doChop(side) {
    if (!game.active) return;
    
    const bottom = game.tree[0];
    if (bottom === side) {
        endGame(false);
        return;
    }
    
    game.score++;
    document.getElementById('current-score').textContent = game.score;
    
    game.timeLeft = Math.min(game.timeLeft + 1, 30);
    
    const lumberjack = document.getElementById('lumberjack');
    lumberjack.className = 'lumberjack ' + side;
    
    const container = document.getElementById('tree');
    const secs = container.querySelectorAll('.trunk-section');
    if (secs.length > 0) secs[0].remove();
    game.tree.shift();
    
    const div = document.createElement('div');
    div.className = 'trunk-section';
    const hasB = Math.random() > 0.3;
    if (hasB) {
        const bs = Math.random() > 0.5 ? 'left' : 'right';
        const b = document.createElement('div');
        b.className = 'branch ' + bs;
        div.appendChild(b);
        game.tree.push(bs);
    } else {
        game.tree.push(null);
    }
    container.appendChild(div);
    
    if (game.score >= game.target) {
        endGame(true);
    }
}

function endGame(win) {
    game.active = false;
    clearInterval(game.timer);
    
    const sym = game.currency === 'ton' ? ' TON' : ' ‚ÇΩ';
    let prize = 0;
    
    if (win) {
        prize = game.bet * 2;
        if (game.currency === 'ton') user.balanceTon += prize;
        else user.balanceRub += prize;
    }
    
    updateBalance();
    
    historyData.games.unshift({
        date: new Date(),
        bet: game.bet,
        currency: game.currency,
        score: game.score,
        win: win,
        prize: win ? prize : 0
    });
    
    const box = document.getElementById('result-box');
    const icon = document.getElementById('result-icon');
    const title = document.getElementById('result-title');
    const msg = document.getElementById('result-message');
    
    if (win) {
        box.className = 'result-content win';
        icon.textContent = 'üèÜ';
        title.textContent = '–ü–æ–±–µ–¥–∞!';
        document.getElementById('result-amount').textContent = '+' + prize + sym;
        msg.textContent = '–û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!';
    } else {
        box.className = 'result-content lose';
        icon.textContent = 'üíÄ';
        title.textContent = '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!';
        document.getElementById('result-amount').textContent = '-' + game.bet + sym;
        msg.textContent = '–ù–µ —Å–¥–∞–≤–∞–π—Å—è! –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑!';
    }
    
    document.getElementById('result-score').textContent = game.score;
    showScreen('result-screen');
}

// –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
function generatePayId() {
    const id = 'SBP_' + user.id + '_' + Date.now().toString().slice(-6);
    document.getElementById('pay-id').textContent = id;
}

function submitDepositTon() {
    const amt = parseFloat(document.getElementById('dep-ton-amount').value);
    const addr = document.getElementById('dep-ton-addr').value;
    
    if (!amt || amt < 1) { notify('–ú–∏–Ω–∏–º—É–º 1 TON'); return; }
    if (!addr) { notify('–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å'); return; }
    
    historyData.deposits.unshift({
        date: new Date(),
        amount: amt,
        currency: 'ton',
        status: 'pending'
    });
    
    notify('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞! –û–∂–∏–¥–∞–π—Ç–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è');
    goHome();
}

function submitDepositRub() {
    const amt = parseFloat(document.getElementById('dep-rub-amount').value);
    
    if (!amt || amt < 100) { notify('–ú–∏–Ω–∏–º—É–º 100 ‚ÇΩ'); return; }
    
    historyData.deposits.unshift({
        date: new Date(),
        amount: amt,
        currency: 'rub',
        status: 'pending'
    });
    
    notify('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞! –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –æ–∂–∏–¥–∞–π—Ç–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è');
    goHome();
}

// –í—ã–≤–æ–¥
function submitWithdrawTon() {
    const addr = document.getElementById('wd-ton-addr').value;
    const amt = parseFloat(document.getElementById('wd-ton-amount').value);
    
    if (!addr) { notify('–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å'); return; }
    if (!amt || amt < 5) { notify('–ú–∏–Ω–∏–º—É–º 5 TON'); return; }
    if (amt > user.balanceTon) { notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤'); return; }
    
    user.balanceTon -= amt;
    updateBalance();
    
    historyData.withdrawals.unshift({
        date: new Date(),
        amount: amt,
        currency: 'ton',
        status: 'pending'
    });
    
    notify('–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞!');
    goHome();
}

function submitWithdrawRub() {
    const phone = document.getElementById('wd-rub-phone').value;
    const amt = parseFloat(document.getElementById('wd-rub-amount').value);
    
    if (!phone) { notify('–£–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞'); return; }
    if (!amt || amt < 500) { notify('–ú–∏–Ω–∏–º—É–º 500 ‚ÇΩ'); return; }
    if (amt > user.balanceRub) { notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤'); return; }
    
    user.balanceRub -= amt;
    updateBalance();
    
    historyData.withdrawals.unshift({
        date: new Date(),
        amount: amt,
        currency: 'rub',
        status: 'pending'
    });
    
    notify('–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞!');
    goHome();
}

// –ò—Å—Ç–æ—Ä–∏—è
function switchTab(tab) {
    document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
    document.getElementById('hist-' + (tab === 'deposits' ? 'deps' : (tab === 'withdrawals' ? 'wds' : 'games'))).classList.add('active');
    renderHistory(tab);
}

function renderHistory(tab) {
    tab = tab || 'games';
    const container = document.getElementById('history-content');
    const data = historyData[tab];
    
    if (!data || data.length === 0) {
        container.innerHTML = '<div class="empty-state">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>';
        return;
    }
    
    container.innerHTML = '';
    data.forEach(item => {
        const div = document.createElement('div');
        div.className = 'history-item';
        
        if (tab === 'games') {
            div.innerHTML = `
                <div class="info">
                    <div class="type">${item.win ? '‚úÖ –ü–æ–±–µ–¥–∞' : '‚ùå –ü–æ—Ä–∞–∂–µ–Ω–∏–µ'}</div>
                    <div class="date">${item.date.toLocaleString()}</div>
                </div>
                <div class="amount ${item.win ? 'positive' : 'negative'}">
                    ${item.win ? '+' : '-'}${item.bet} ${item.currency.toUpperCase()}
                </div>
            `;
        } else {
            div.innerHTML = `
                <div class="info">
                    <div class="type">${tab === 'deposits' ? 'üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ' : 'üí∏ –í—ã–≤–æ–¥'}</div>
                    <div class="date">${item.date.toLocaleString()}</div>
                </div>
                <div class="amount ${tab === 'deposits' ? 'positive' : 'negativee6c200 100%);
    color: #000;
    font-size: 18px;
}

.btn-secondary {
    background: #1a1a2e;
    color: white;
    border: 1px solid #2a2a4a;
}

.btn-info {
    background: transparent;
    color: #a0a0b0;
    border: 1px solid #2a2a4a;
}

.btn-row {
    display: flex;
    gap: 12px;
}

.btn-row .btn {
    flex: 1;
}

.screen-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 30, 0.98);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    z-index: 1000;
    border-bottom: 1px solid #2a2a4a;
    padding-top: 60px;
}

.back-btn {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: white;
    width: 44px;
    height: 44px;
    border-radius: 12px;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.bet-container { padding: 20px; }

.section { margin-bottom: 24px; }

.section label {
    display: block;
    color: #a0a0b0;
    font-size: 14px;
    margin-bottom: 12px;
}

.currency-tabs {
    display: flex;
    gap: 8px;
    background: #1a1a2e;
    padding: 4px;
    border-radius: 12px;
}

.currency-tab {
    flex: 1;
    background: transparent;
    border: none;
    color: #a0a0b0;
    padding: 14px;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
}

.currency-tab.active {
    background: #ffd700;
    color: #000;
}

.bet-amount {
    font-size: 48px;
    font-weight: 800;
    text-align: center;
    color: #ffd700;
    margin: 20px 0;
}

.bet-slider {
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: #1a1a2e;
    outline: none;
    -webkit-appearance: none;
    margin: 20px 0;
}

.bet-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: #ffd700;
    cursor: pointer;
}

.bet-presets {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.bet-presets button {
    flex: 1;
    min-width: 60px;
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: white;
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
}

.prize-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin: 24px 0;
}

.prize-card {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 16px;
    padding: 20px;
    text-align: center;
}

.prize-card.win { border-color: #00ff88; }

.prize-label {
    font-size: 12px;
    color: #a0a0b0;
    margin-bottom: 8px;
}

.prize-value {
    font-size: 24px;
    font-weight: 700;
    color: #ffd700;
}

.prize-card.win .prize-value { color: #00ff88; }

.rules-box {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 20px;
    margin: 24px 0;
}

.rules-box li {
    padding: 8px 0;
    padding-left: 24px;
    position: relative;
    color: #a0a0b0;
    font-size: 14px;
    list-style: none;
}

.rules-box li:before {
    content: "‚úì";
    position: absolute;
    left: 0;
    color: #00ff88;
}

.time-bar {
    position: fixed;
    top: 70px;
    left: 0;
    right: 0;
    height: 6px;
    background: #1a1a2e;
    z-index: 100;
}

.time-fill {
    height: 100%;
    background: linear-gradient(90deg, #00ff88 0%, #ffd700 50%, #ff4757 100%);
    width: 100%;
    transition: width 0.1s linear;
}

.score-board {
    text-align: center;
    padding: 40px 20px 20px;
}

.current-score {
    font-size: 72px;
    font-weight: 800;
    color: #ffd700;
    line-height: 1;
}

.target-display {
    margin-top: 10px;
    color: #a0a0b0;
    font-size: 16px;
}

.game-area {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 300px;
}

.tree-container {
    position: relative;
    width: 120px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    gap: 4px;
}

.trunk-section {
    width: 80px;
    height: 60px;
    background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
    border: 3px solid #5D3A1A;
    border-radius: 8px;
    position: relative;
}

.branch {
    position: absolute;
    width: 50px;
    height: 16px;
    background: linear-gradient(90deg, #228B22 0%, #32CD32 100%);
    border: 2px solid #006400;
    border-radius: 10px;
    top: 50%;
    transform: translateY(-50%);
}

.branch.left { left: -45px; }
.branch.right { right: -45px; }

.lumberjack {
    position: absolute;
    bottom: -90px;
    width: 70px;
    height: 80px;
    transition: all 0.15s;
    z-index: 10;
}

.lumberjack.left { left: -80px; }
.lumberjack.right { right: -80px; transform: scaleX(-1); }

.lumberjack-body {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #ff6b6b 0%, #c92a2a 100%);
    border-radius: 12px;
    position: relative;
}

.head {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
}

.axe {
    position: absolute;
    right: -25px;
    top: 20px;
    font-size: 30px;
}

.game-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 20px;
    background: linear-gradient(0deg, #0f0f1e 0%, transparent 100%);
    display: flex;
    gap: 16px;
    z-index: 100;
}

.chop-btn {
    flex: 1;
    height: 80px;
    border: none;
    border-radius: 20px;
    font-size: 36px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 8px 0 rgba(0,0,0,0.3);
}

.chop-btn.left {
    background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
    color: white;
}

.chop-btn.right {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
    color: white;
}

#result-screen {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.result-content {
    text-align: center;
    width: 100%;
    max-width: 400px;
}

.result-icon { font-size: 80px; margin-bottom: 20px; }

.result-content h2 {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 24px;
}

.result-content.win h2 { color: #00ff88; }
.result-content.lose h2 { color: #ff4757; }

.result-stats {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
}

.stat {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid #2a2a4a;
}

.stat:last-child { border-bottom: none; }

.stat-label { color: #a0a0b0; }
.stat-value { font-weight: 700; font-size: 18px; }

.result-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.deposit-options, .withdraw-options {
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.option-card {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 20px;
    padding: 24px;
    text-align: center;
}

.option-icon { font-size: 48px; margin-bottom: 12px; }

.option-card h3 { font-size: 20px; margin-bottom: 8px; }
.option-card p { color: #a0a0b0; font-size: 14px; margin-bottom: 8px; }
.option-card small { color: #ffd700; font-size: 12px; font-weight: 600; }

.deposit-form, .withdraw-form { padding: 20px; }

.info-box, .bank-card, .payment-id-box {
    background: #1a1a2e;
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
}

.copy-box {
    background: #0f0f1e;
    border: 2px dashed #2a2a4a;
    border-radius: 12px;
    padding: 16px;
    text-align: center;
}

.copy-box code {
    display: block;
    font-family: monospace;
    font-size: 13px;
    word-break: break-all;
    color: #ffd700;
    margin-bottom: 8px;
}

.copy-hint { font-size: 12px; color: #a0a0b0; }

.copy-box.important {
    border-color: #ff4757;
    background: rgba(255, 71, 87, 0.05);
}

.copy-box.important code {
    color: #ff4757;
    font-size: 16px;
    font-weight: 700;
}

.bank-card.sbp {
    background: linear-gradient(135deg, #0057b8 0%, #003d82 100%);
}

.bank-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.bank-logo { font-weight: 800; font-size: 20px; }

.sbp-badge {
    background: white;
    color: #0057b8;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 700;
}

.bank-phone {
    font-size: 22px;
    font-weight: 700;
    text-align: center;
    padding: 12px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
}

.form-group { margin-bottom: 20px; }

.form-group label {
    display: block;
    font-size: 14px;
    color: #a0a0b0;
    margin-bottom: 8px;
}

.form-group input, .form-group select {
    width: 100%;
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    border-radius: 12px;
    padding: 16px;
    color: white;
    font-size: 16px;
}

.balance-info {
    background: #1a1a2e;
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 20px;
    text-align: center;
    color: #a0a0b0;
}

.balance-info strong { color: #ffd700; font-size: 20px; }

.hint {
    text-align: center;
    color: #a0a0b0;
    font-size: 13px;
    margin-top: 16px;
}

.history-tabs {
    display: flex;
    gap: 8px;
    padding: 0 20px;
    margin-bottom: 20px;
    overflow-x: auto;
}

.tab-btn {
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    color: #a0a0b0;
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    white-space: nowrap;
}

.tab-btn.active {
    background: #ffd700;
    color: #000;
    border-color: #ffd700;
}

.history-list { padding: 0 20px; }

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: #a0a0b0;
}

.notification {
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    background: #1a1a2e;
    border: 1px solid #2a2a4a;
    padding: 16px 24px;
    border-radius: 12px;
    z-index: 10000;
    animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
    from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
    to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

.wood-chip {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #DEB887;
    border-radius: 2px;
    pointer-events: none;
    animation: chipFly 0.5s ease-out forwards;
}

@keyframes chipFly {
    0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
    100% { transform: translate(var(--tx), var(--ty)) rotate(var(--rot)); opacity: 0; }
}
    </style>
</head>
<body>
    <div class="header">
        <div class="balance-display">
            <div class="balance-item">
                <span>üíé</span>
                <span id="balance-ton">0.00</span> TON
            </div>
            <div class="balance-item">
                <span>‚ÇΩ</span>
                <span id="balance-rub">0</span>
            </div>
        </div>
        <button class="menu-btn" onclick="goHome()">üè†</button>
    </div>

    <div id="main-screen" class="screen active">
        <div class="logo-section">
            <div class="logo-icon">ü™ì</div>
            <h1>TimberTON</h1>
            <p class="subtitle">–†—É–±–∏ –¥–µ—Ä–µ–≤—å—è ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π TON –∏ —Ä—É–±–ª–∏!</p>
        </div>

        <div class="game-preview">
            <div class="preview-tree">üå≤</div>
            <div class="preview-lumberjack">ü™ì</div>
        </div>

        <div class="main-actions">
            <button class="btn btn-primary" onclick="openGameMenu()">üéÆ –ò–ì–†–ê–¢–¨</button>
            <div class="btn-row">
                <button class="btn btn-secondary" onclick="openDeposit()">üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
                <button class="btn btn-secondary" onclick="openWithdraw()">üí∏ –í—ã–≤–µ—Å—Ç–∏</button>
            </div>
            <button class="btn btn-info" onclick="openHistory()">üìä –ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä</button>
        </div>
    </div>

    <div id="game-menu-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
        </div>

        <div class="bet-container">
            <div class="section">
                <label>–í–∞–ª—é—Ç–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="currency-tabs">
                    <button class="currency-tab active" id="btn-ton" onclick="setCurrency('ton')">üíé TON</button>
                    <button class="currency-tab" id="btn-rub" onclick="setCurrency('rub')">‚ÇΩ –†—É–±–ª–∏</button>
                </div>
            </div>

            <div class="section">
                <label>–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏:</label>
                <div class="bet-amount" id="bet-display">0.5 TON</div>
                <input type="range" class="bet-slider" id="bet-slider" min="0.5" max="10" step="0.5" value="0.5" oninput="updateBet(this.value)">
                <div class="bet-presets" id="bet-presets">
                    <button onclick="setBetValue(0.5)">0.5</button>
                    <button onclick="setBetValue(1)">1</button>
                    <button onclick="setBetValue(2)">2</button>
                    <button onclick="setBetValue(5)">5</button>
                    <button onclick="setBetValue(10)">10</button>
                </div>
            </div>

            <div class="prize-info">
                <div class="prize-card">
                    <div class="prize-label">üéØ –¶–µ–ª—å</div>
                    <div class="prize-value" id="target-score">50</div>
                    <small>–æ—á–∫–æ–≤ –∑–∞ 30 —Å–µ–∫</small>
                </div>
                <div class="prize-card win">
                    <div class="prize-label">üèÜ –í—ã–∏–≥—Ä—ã—à</div>
                    <div class="prize-value" id="prize-amount">1.0 TON</div>
                    <small>x2 –æ—Ç —Å—Ç–∞–≤–∫–∏</small>
                </div>
            </div>

            <div class="rules-box">
                <h4>üìã –ü—Ä–∞–≤–∏–ª–∞:</h4>
                <ul>
                    <li>–†—É–±–∏ –¥–µ—Ä–µ–≤–æ –∫–Ω–æ–ø–∫–∞–º–∏ ‚Üê ‚Üí</li>
                    <li>–ò–∑–±–µ–≥–∞–π –≤–µ—Ç–æ–∫ ‚Äî –∏–Ω–∞—á–µ –ø—Ä–æ–∏–≥—Ä—ã—à!</li>
                    <li>–ö–∞–∂–¥—ã–π —É–¥–∞—Ä = +1 –æ—á–∫–æ</li>
                    <li>–ù–∞–±–µ—Ä–∏ —Ü–µ–ª—å –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è</li>
                </ul>
            </div>

            <button class="btn btn-primary" onclick="startGame()">‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨ –ò–ì–†–£</button>
        </div>
    </div>

    <div id="play-screen" class="screen">
        <div class="time-bar">
            <div class="time-fill" id="time-fill"></div>
        </div>

        <div class="score-board">
            <div class="current-score" id="current-score">0</div>
            <div class="target-display">–¶–µ–ª—å: <span id="game-target">50</span></div>
        </div>

        <div class="game-area">
            <div class="tree-container" id="tree">
                <div class="lumberjack left" id="lumberjack">
                    <div class="lumberjack-body">
                        <div class="head">üë∑</div>
                        <div class="axe">ü™ì</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-controls">
            <button class="chop-btn left" ontouchstart="doChop('left'); return false;" onmousedown="doChop('left')">‚Üê</button>
            <button class="chop-btn right" ontouchstart="doChop('right'); return false;" onmousedown="doChop('right')">‚Üí</button>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <div class="result-content" id="result-box">
            <div class="result-icon" id="result-icon">üèÜ</div>
            <h2 id="result-title">–ü–æ–±–µ–¥–∞!</h2>
            
            <div class="result-stats">
                <div class="stat">
                    <span class="stat-label">–û—á–∫–∏:</span>
                    <span class="stat-value" id="result-score">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                    <span class="stat-value" id="result-amount">+1.0 TON</span>
                </div>
            </div>

            <div class="result-message" id="result-message">–û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞!</div>

            <div class="result-actions">
                <button class="btn btn-primary" onclick="openGameMenu()">üîÑ –ò–≥—Ä–∞—Ç—å –µ—â—ë</button>
                <button class="btn btn-secondary" onclick="goHome()">üè† –í –º–µ–Ω—é</button>
            </div>
        </div>
    </div>

    <div id="deposit-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h2>
        </div>

        <div class="deposit-options">
            <div class="option-card" onclick="showScreen('deposit-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h3>
                <p>–û—Ç–ø—Ä–∞–≤—å TON –Ω–∞ –∞–¥—Ä–µ—Å –ø—Ä–æ–µ–∫—Ç–∞</p>
                <small>–ú–∏–Ω–∏–º—É–º: 1 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('deposit-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h3>
                <p>–ü–µ—Ä–µ–≤–æ–¥ –ø–æ –°–ë–ü –Ω–∞ OZON –ë–∞–Ω–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 100 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="deposit-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å TON</h2>
        </div>

        <div class="deposit-form">
            <div class="info-box">
                <h4>–ê–¥—Ä–µ—Å –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:</h4>
                <div class="copy-box" onclick="copyText('UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh')">
                    <code>UQD-U9iJRqGCZhtJRg7GDvUUP-IwhGu1jAknZXdRmxR3pSOh</code>
                    <span class="copy-hint">üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°–∫–æ–ª—å–∫–æ TON –æ—Ç–ø—Ä–∞–≤–∏–ª–∏:</label>
                <input type="number" id="dep-ton-amount" step="0.1" min="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5">
            </div>

            <div class="form-group">
                <label>–í–∞—à TON-–∞–¥—Ä–µ—Å:</label>
                <input type="text" id="dep-ton-addr" placeholder="UQ...">
            </div>

            <button class="btn btn-primary" onclick="submitDepositTon()">‚úÖ –Ø –æ—Ç–ø—Ä–∞–≤–∏–ª TON</button>
            <p class="hint">–ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏</p>
        </div>
    </div>

    <div id="deposit-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('deposit-screen')">‚Üê</button>
            <h2>‚ÇΩ –ü–æ–ø–æ–ª–Ω–∏—Ç—å —Ä—É–±–ª–∏</h2>
        </div>

        <div class="deposit-form">
            <div class="bank-card sbp">
                <div class="bank-header">
                    <span class="bank-logo">OZON</span>
                    <span class="sbp-badge">–°–ë–ü</span>
                </div>
                <div class="bank-phone" onclick="copyText('+79941402339')">
                    +7 (994) 140-23-39
                    <small>üìã –ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</small>
                </div>
            </div>

            <div class="payment-id-box">
                <h4>–í–∞—à ID –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:</h4>
                <div class="copy-box important">
                    <code id="pay-id">–ó–∞–≥—Ä—É–∑–∫–∞...</code>
                    <span class="copy-hint">‚ö†Ô∏è –£–∫–∞–∂–∏ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–µ—Ä–µ–≤–æ–¥—É!</span>
                </div>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ (‚ÇΩ):</label>
                <input type="number" id="dep-rub-amount" min="100" step="100" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 500">
            </div>

            <button class="btn btn-primary" onclick="submitDepositRub()">‚úÖ –Ø –æ–ø–ª–∞—Ç–∏–ª</button>
            <p class="hint">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 5-15 –º–∏–Ω—É—Ç</p>
        </div>
    </div>

    <div id="withdraw-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h2>
        </div>

        <div class="withdraw-options">
            <div class="option-card" onclick="showScreen('withdraw-ton-screen')">
                <div class="option-icon">üíé</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ TON</h3>
                <p>–ù–∞ –≤–∞—à TON-–∫–æ—à–µ–ª—ë–∫</p>
                <small>–ú–∏–Ω–∏–º—É–º: 5 TON</small>
            </div>

            <div class="option-card" onclick="showScreen('withdraw-rub-screen')">
                <div class="option-icon">‚ÇΩ</div>
                <h3>–í—ã–≤–µ—Å—Ç–∏ —Ä—É–±–ª–∏</h3>
                <p>–ù–∞ –∫–∞—Ä—Ç—É —á–µ—Ä–µ–∑ –°–ë–ü</p>
                <small>–ú–∏–Ω–∏–º—É–º: 500 ‚ÇΩ</small>
            </div>
        </div>
    </div>

    <div id="withdraw-ton-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>üíé –í—ã–≤–æ–¥ TON</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="wd-ton-bal">0.00</strong> TON
            </div>

            <div class="form-group">
                <label>TON-–∞–¥—Ä–µ—Å:</label>
                <input type="text" id="wd-ton-addr" placeholder="UQ...">
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞:</label>
                <input type="number" id="wd-ton-amount" step="0.1" min="5" placeholder="–ú–∏–Ω–∏–º—É–º 5 TON">
            </div>

            <button class="btn btn-primary" onclick="submitWithdrawTon()">üöÄ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥</button>
            <p class="hint">–û–±—Ä–∞–±–æ—Ç–∫–∞: –¥–æ 24 —á–∞—Å–æ–≤</p>
        </div>
    </div>

    <div id="withdraw-rub-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="showScreen('withdraw-screen')">‚Üê</button>
            <h2>‚ÇΩ –í—ã–≤–æ–¥ —Ä—É–±–ª–µ–π</h2>
        </div>

        <div class="withdraw-form">
            <div class="balance-info">
                –î–æ—Å—Ç—É–ø–Ω–æ: <strong id="wd-rub-bal">0</strong> ‚ÇΩ
            </div>

            <div class="form-group">
                <label>–¢–µ–ª–µ—Ñ–æ–Ω (–°–ë–ü):</label>
                <input type="tel" id="wd-rub-phone" placeholder="+7 (999) 123-45-67">
            </div>

            <div class="form-group">
                <label>–ë–∞–Ω–∫:</label>
                <select id="wd-rub-bank">
                    <option value="–°–±–µ—Ä–±–∞–Ω–∫">üè¶ –°–±–µ—Ä–±–∞–Ω–∫</option>
                    <option value="–¢–∏–Ω—å–∫–æ—Ñ—Ñ">üü° –¢–∏–Ω—å–∫–æ—Ñ—Ñ</option>
                    <option value="–í–¢–ë">üîµ –í–¢–ë</option>
                    <option value="–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫">üü£ –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫</option>
                    <option value="–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω">üü¢ –†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω</option>
                    <option value="–î—Ä—É–≥–æ–π">‚ö™ –î—Ä—É–≥–æ–π</option>
                </select>
            </div>

            <div class="form-group">
                <label>–°—É–º–º–∞ (‚ÇΩ):</label>
                <input type="number" id="wd-rub-amount" min="500" step="100" placeholder="–ú–∏–Ω–∏–º—É–º 500 ‚ÇΩ">
            </div>

            <button class="btn btn-primary" onclick="submitWithdrawRub()">üöÄ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥</button>
            <p class="hint">–û–±—Ä–∞–±–æ—Ç–∫–∞: –¥–æ 24 —á–∞—Å–æ–≤</p>
        </div>
    </div>

    <div id="history-screen" class="screen">
        <div class="screen-header">
            <button class="back-btn" onclick="goHome()">‚Üê</button>
            <h2>üìä –ò—Å—Ç–æ—Ä–∏—è</h2>
        </div>

        <div class="history-tabs">
            <button class="tab-btn active" id="hist-games" onclick="switchTab('games')">üéÆ –ò–≥—Ä—ã</button>
            <button class="tab-btn" id="hist-deps" onclick="switchTab('deposits')">üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏—è</button>
            <button class="tab-btn" id="hist-wds" onclick="switchTab('withdrawals')">üí∏ –í—ã–≤–æ–¥—ã</button>
        </div>

        <div class="history-list" id="history-content">
            <div class="empty-state">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>
        </div>
    </div>

    <div id="notification" class="notification hidden">
        <span id="notif-text"></span>
    </div>

    <script>
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let user = {
    id: 'demo',
    balanceTon: 10.00,
    balanceRub: 1000,
    username: 'player'
};

let game = {
    active: false,
    score: 0,
    target: 50,
    timeLeft: 30,
    timer: null,
    bet: 0.5,
    currency: 'ton',
    position: 'left',
    tree: []
};

let historyData = {
    games: [],
    deposits: [],
    withdrawals: []
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
let tg = null;
try {
    tg = window.Telegram.WebApp;
    tg.expand();
    tg.ready();
    if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
        user.id = tg.initDataUnsafe.user.id.toString();
        user.username = tg.initDataUnsafe.user.username || 'player';
    }
} catch(e) {
    console.log('Telegram WebApp not available');
}

// –ù–∞–≤–∏–≥–∞—Ü–∏—è
function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    
    if (id === 'deposit-rub-screen') {
        generatePayId();
    } else if (id === 'withdraw-ton-screen') {
        document.getElementById('wd-ton-bal').textContent = user.balanceTon.toFixed(2);
    } else if (id === 'withdraw-rub-screen') {
        document.getElementById('wd-rub-bal').textContent = user.balanceRub;
    } else if (id === 'history-screen') {
        renderHistory();
    }
}

function goHome() {
    showScreen('main-screen');
    updateBalance();
}

function openGameMenu() {
    showScreen('game-menu-screen');
    setCurrency('ton');
}

function openDeposit() {
    showScreen('deposit-screen');
}

function openWithdraw() {
    showScreen('withdraw-screen');
}

function openHistory() {
    showScreen('history-screen');
    switchTab('games');
}

// –ò–≥—Ä–∞ - –º–µ–Ω—é —Å—Ç–∞–≤–æ–∫
function setCurrency(curr) {
    game.currency = curr;
    document.getElementById('btn-ton').classList.toggle('active', curr === 'ton');
    document.getElementById('btn-rub').classList.toggle('active', curr === 'rub');
    
    const isTon = curr === 'ton';
    const slider = document.getElementById('bet-slider');
    const presets = document.getElementById('bet-presets');
    
    slider.min = isTon ? 0.5 : 50;
    slider.max = isTon ? 10 : 1000;
    slider.step = isTon ? 0.5 : 50;
    slider.value = isTon ? 0.5 : 50;
    
    presets.innerHTML = '';
    const vals = isTon ? [0.5, 1, 2, 5, 10] : [50, 100, 250, 500, 1000];
    vals.forEach(v => {
        const b = document.createElement('button');
        b.textContent = v;
        b.onclick = function() { setBetValue(v); };
        presets.appendChild(b);
    });
    
    updateBet(slider.value);
}

function updateBet(val) {
    game.bet = parseFloat(val);
    const sym = game.currency === 'ton' ? ' TON' : ' ‚ÇΩ';
    document.getElementById('bet-display').textContent = val + sym;
    
    const target = Math.floor(30 + (game.bet * (game.currency === 'ton' ? 20 : 0.4)));
    game.target = target;
    document.getElementById('target-score').textContent = target;
    
    const prize = game.bet * 2;
    document.getElementById('prize-amount').textContent = prize + sym;
}

function setBetValue(val) {
    document.getElementById('bet-slider').value = val;
    updateBet(val);
}

// –ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å
function startGame() {
    const bal = game.currency === 'ton' ? user.balanceTon : user.balanceRub;
    if (bal < game.bet) {
        notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
        return;
    }
    
    if (game.currency === 'ton') user.balanceTon -= game.bet;
    else user.balanceRub -= game.bet;
    updateBalance();
    
    game.active = true;
    game.score = 0;
    game.timeLeft = 30;
    game.tree = [];
    
    showScreen('play-screen');
    document.getElementById('current-score').textContent = '0';
    document.getElementById('game-target').textContent = game.target;
    document.getElementById('time-fill').style.width = '100%';
    
    generateTree();
    
    game.timer = setInterval(function() {
        game.timeLeft -= 0.1;
        const pct = (game.timeLeft / 30) * 100;
        document.getElementById('time-fill').style.width = pct + '%';
        
        if (game.timeLeft <= 0) {
            endGame(false);
        }
    }, 100);
}

function generateTree() {
    const container = document.getElementById('tree');
    const sections = container.querySelectorAll('.trunk-section');
    sections.forEach(s => s.remove());
    
    game.tree = [];
    
    for (let i = 0; i < 6; i++) {
        const div = document.createElement('div');
        div.className = 'trunk-section';
        
        const hasBranch = Math.random() > 0.3 && i > 0;
        if (hasBranch) {
            const side = Math.random() > 0.5 ? 'left' : 'right';
            const b = document.createElement('div');
            b.className = 'branch ' + side;
            div.appendChild(b);
            game.tree.push(side);
        } else {
            game.tree.push(null);
        }
        
        container.appendChild(div);
    }
}

function doChop(side) {
    if (!game.active) return;
    
    const bottom = game.tree[0];
    if (bottom === side) {
        endGame(false);
        return;
    }
    
    game.score++;
    document.getElementById('current-score').textContent = game.score;
    
    game.timeLeft = Math.min(game.timeLeft + 1, 30);
    
    const lumberjack = document.getElementById('lumberjack');
    lumberjack.className = 'lumberjack ' + side;
    
    const container = document.getElementById('tree');
    const secs = container.querySelectorAll('.trunk-section');
    if (secs.length > 0) secs[0].remove();
    game.tree.shift();
    
    const div = document.createElement('div');
    div.className = 'trunk-section';
    const hasB = Math.random() > 0.3;
    if (hasB) {
        const bs = Math.random() > 0.5 ? 'left' : 'right';
        const b = document.createElement('div');
        b.className = 'branch ' + bs;
        div.appendChild(b);
        game.tree.push(bs);
    } else {
        game.tree.push(null);
    }
    container.appendChild(div);
    
    if (game.score >= game.target) {
        endGame(true);
    }
}

function endGame(win) {
    game.active = false;
    clearInterval(game.timer);
    
    const sym = game.currency === 'ton' ? ' TON' : ' ‚ÇΩ';
    let prize = 0;
    
    if (win) {
        prize = game.bet * 2;
        if (game.currency === 'ton') user.balanceTon += prize;
        else user.balanceRub += prize;
    }
    
    updateBalance();
    
    historyData.games.unshift({
        date: new Date(),
        bet: game.bet,
        currency: game.currency,
        score: game.score,
        win: win,
        prize: win ? prize : 0
    });
    
    const box = document.getElementById('result-box');
    const icon = document.getElementById('result-icon');
    const title = document.getElementById('result-title');
    const msg = document.getElementById('result-message');
    
    if (win) {
        box.className = 'result-content win';
        icon.textContent = 'üèÜ';
        title.textContent = '–ü–æ–±–µ–¥–∞!';
        document.getElementById('result-amount').textContent = '+' + prize + sym;
        msg.textContent = '–û—Ç–ª–∏—á–Ω–∞—è –∏–≥—Ä–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!';
    } else {
        box.className = 'result-content lose';
        icon.textContent = 'üíÄ';
        title.textContent = '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ!';
        document.getElementById('result-amount').textContent = '-' + game.bet + sym;
        msg.textContent = '–ù–µ —Å–¥–∞–≤–∞–π—Å—è! –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑!';
    }
    
    document.getElementById('result-score').textContent = game.score;
    showScreen('result-screen');
}

// –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
function generatePayId() {
    const id = 'SBP_' + user.id + '_' + Date.now().toString().slice(-6);
    document.getElementById('pay-id').textContent = id;
}

function submitDepositTon() {
    const amt = parseFloat(document.getElementById('dep-ton-amount').value);
    const addr = document.getElementById('dep-ton-addr').value;
    
    if (!amt || amt < 1) { notify('–ú–∏–Ω–∏–º—É–º 1 TON'); return; }
    if (!addr) { notify('–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å'); return; }
    
    historyData.deposits.unshift({
        date: new Date(),
        amount: amt,
        currency: 'ton',
        status: 'pending'
    });
    
    notify('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞! –û–∂–∏–¥–∞–π—Ç–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è');
    goHome();
}

function submitDepositRub() {
    const amt = parseFloat(document.getElementById('dep-rub-amount').value);
    
    if (!amt || amt < 100) { notify('–ú–∏–Ω–∏–º—É–º 100 ‚ÇΩ'); return; }
    
    historyData.deposits.unshift({
        date: new Date(),
        amount: amt,
        currency: 'rub',
        status: 'pending'
    });
    
    notify('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞! –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –æ–∂–∏–¥–∞–π—Ç–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è');
    goHome();
}

// –í—ã–≤–æ–¥
function submitWithdrawTon() {
    const addr = document.getElementById('wd-ton-addr').value;
    const amt = parseFloat(document.getElementById('wd-ton-amount').value);
    
    if (!addr) { notify('–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å'); return; }
    if (!amt || amt < 5) { notify('–ú–∏–Ω–∏–º—É–º 5 TON'); return; }
    if (amt > user.balanceTon) { notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤'); return; }
    
    user.balanceTon -= amt;
    updateBalance();
    
    historyData.withdrawals.unshift({
        date: new Date(),
        amount: amt,
        currency: 'ton',
        status: 'pending'
    });
    
    notify('–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞!');
    goHome();
}

function submitWithdrawRub() {
    const phone = document.getElementById('wd-rub-phone').value;
    const amt = parseFloat(document.getElementById('wd-rub-amount').value);
    
    if (!phone) { notify('–£–∫–∞–∂–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞'); return; }
    if (!amt || amt < 500) { notify('–ú–∏–Ω–∏–º—É–º 500 ‚ÇΩ'); return; }
    if (amt > user.balanceRub) { notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤'); return; }
    
    user.balanceRub -= amt;
    updateBalance();
    
    historyData.withdrawals.unshift({
        date: new Date(),
        amount: amt,
        currency: 'rub',
        status: 'pending'
    });
    
    notify('–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞!');
    goHome();
}

// –ò—Å—Ç–æ—Ä–∏—è
function switchTab(tab) {
    document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
    document.getElementById('hist-' + (tab === 'deposits' ? 'deps' : (tab === 'withdrawals' ? 'wds' : 'games'))).classList.add('active');
    renderHistory(tab);
}

function renderHistory(tab) {
    tab = tab || 'games';
    const container = document.getElementById('history-content');
    const data = historyData[tab];
    
    if (!data || data.length === 0) {
        container.innerHTML = '<div class="empty-state">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</div>';
        return;
    }
    
    container.innerHTML = '';
    data.forEach(item => {
        const div = document.createElement('div');
        div.className = 'history-item';
        
        if (tab === 'games') {
            div.innerHTML = `
                <div class="info">
                    <div class="type">${item.win ? '‚úÖ –ü–æ–±–µ–¥–∞' : '‚ùå –ü–æ—Ä–∞–∂–µ–Ω–∏–µ'}</div>
                    <div class="date">${item.date.toLocaleString()}</div>
                </div>
                <div class="amount ${item.win ? 'positive' : 'negative'}">
                    ${item.win ? '+' : '-'}${item.bet} ${item.currency.toUpperCase()}
                </div>
            `;
        } else {
            div.innerHTML = `
                <div class="info">
                    <div class="type">${tab === 'deposits' ? 'üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ' : 'üí∏ –í—ã–≤–æ–¥'}</div>
                    <div class="date">${item.date.toLocaleString()}</div>
                </div>
                <div class="amount ${tab === 'deposits' ? 'positive' : 'negative'}">
                    ${tab === 'deposits' ? '+' : '-'}${item.amount} ${item.currency.toUpperCase()}
                </div>
            `;
        }
        
        container.appendChild(div);
    });
}

// –£—Ç–∏–ª–∏—Ç—ã
function updateBalance() {
    document.getElementById('balance-ton').textContent = user.balanceTon.toFixed(2);
    document.getElementById('balance-rub').textContent = user.balanceRub;
}

function copyText(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => notify('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!'));
    } else {
        const inp = document.createElement('input');
        inp.value = text;
        document.body.appendChild(inp);
        inp.select();
        document.execCommand('copy');
        document.body.removeChild(inp);
        notify('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!');
    }
}

function notify(text) {
    const n = document.getElementById('notification');
    document.getElementById('notif-text').textContent = text;
    n.classList.remove('hidden');
    setTimeout(() => n.classList.add('hidden'), 3000);
}

// –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
document.addEventListener('keydown', function(e) {
    if (!game.active) return;
    if (e.key === 'ArrowLeft') doChop('left');
    if (e.key === 'ArrowRight') doChop('right');
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
updateBalance();
    </script>
</body>
</html>
